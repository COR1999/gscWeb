"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[7486],{97486:(e,t,n)=>{let r;n.r(t),n.d(t,{default:()=>oF});var i,o,a,s,u=n(95155),l=n(11748),c=n(77525),d=n(12115),p=n(47650);let f=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,m=/_key\s*==\s*['"](.*)['"]/,y=/^\d*:\d*$/;function h(e){return"number"==typeof e||"string"==typeof e&&/^\[\d+\]$/.test(e)}function v(e){return"string"==typeof e?m.test(e.trim()):"object"==typeof e&&"_key"in e}function g(e){if("string"==typeof e&&y.test(e))return!0;if(!Array.isArray(e)||2!==e.length)return!1;let[t,n]=e;return("number"==typeof t||""===t)&&("number"==typeof n||""===n)}function b(e){if(!Array.isArray(e))throw Error("Path is not an array");return e.reduce((e,t,n)=>{let r=typeof t;if("number"===r)return`${e}[${t}]`;if("string"===r)return`${e}${0===n?"":"."}${t}`;if(v(t)&&t._key)return`${e}[_key=="${t._key}"]`;if(Array.isArray(t)){let[n,r]=t;return`${e}[${n}:${r}]`}throw Error(`Unsupported path segment \`${JSON.stringify(t)}\``)},"")}function w(e){if("string"!=typeof e)throw Error("Path is not a string");let t=e.match(f);if(!t)throw Error("Invalid path string");return t.map(x)}function x(e){return h(e)?Number(e.replace(/[^\d]/g,"")):v(e)?{_key:e.match(m)[1]}:g(e)?function(e){let[t,n]=e.split(":").map(e=>""===e?e:Number(e));return[t,n]}(e):e}var E=Object.freeze({__proto__:null,fromString:w,get:function(e,t,n){let r="string"==typeof t?w(t):t;if(!Array.isArray(r))throw Error("Path must be an array or a string");let i=e;for(let e=0;e<r.length;e++){let t=r[e];if(h(t)){if(!Array.isArray(i))return n;i=i[t]}if(v(t)){if(!Array.isArray(i))return n;i=i.find(e=>e._key===t._key)}if("string"==typeof t&&(i="object"==typeof i&&null!==i?i[t]:void 0),typeof i>"u")return n}return i},isIndexSegment:h,isIndexTuple:g,isKeySegment:v,reKeySegment:m,toString:b});let _="drafts.";function j(e){return e.startsWith(_)}function k(e){return e.startsWith("versions.")}function I(e){return k(e)?_+S(e):j(e)?e:_+e}function S(e){return k(e)?e.split(".").slice(2).join("."):j(e)?e.slice(_.length):e}var M=n(64509),$=n(50625);function A(e){return e.split(/[[.\]]/g).filter(Boolean).map(e=>{var t;return e.includes("==")?function(e){let[t,n]=e.split("==");if("_key"!==t)throw Error(`Currently only "_key" is supported as path segment. Found ${t}`);if(typeof n>"u")throw Error('Invalid path segment, expected `key=="value"`');return{_key:n.replace(/^['"]/,"").replace(/['"]$/,"")}}(e):C.test(t=e)?Number(t):t})}let C=/^-?\d+$/,O=/^[a-z_$]+/;function T(e){return e.map((e,t)=>{var n;return n=0===t,Array.isArray(e)?`[${e[0]}:${e[1]||""}]`:"number"==typeof e?`[${e}]`:"object"==typeof e&&"_key"in e&&"string"==typeof e._key?`[_key==${JSON.stringify(e._key)}]`:"string"==typeof e&&O.test(e)?n?e:`.${e}`:`['${e}']`}).join("")}function P(e){if("createIfNotExists"in e)return{type:"createIfNotExists",document:e.createIfNotExists};if("createOrReplace"in e)return{type:"createOrReplace",document:e.createOrReplace};if("create"in e)return{type:"create",document:e.create};if("delete"in e)return{id:e.delete.id,type:"delete"};if("patch"in e){var t,n,r,i,o,a;return{type:"patch",id:e.patch.id,patches:[..."set"in(n=t=e.patch)?Object.keys(n.set).map(e=>({path:A(e),op:{type:"set",value:n.set[e]}})):[],..."setIfMissing"in(r=t)?Object.keys(r.setIfMissing).map(e=>({path:A(e),op:{type:"setIfMissing",value:r.setIfMissing[e]}})):[],..."unset"in(i=t)?i.unset.map(e=>({path:A(e),op:{type:"unset"}})):[],..."inc"in(o=t)?Object.keys(o.inc).map(e=>({path:A(e),op:{type:"inc",amount:o.inc[e]}})):[],..."inc"in(a=t)?Object.keys(a.dec).map(e=>({path:A(e),op:{type:"dec",amount:a.dec[e]}})):[],...function(e){if(!("insert"in e))return[];let t=function(e){let t=R.filter(t=>t in e);if(t.length>1)throw Error(`Insert patch is ambiguous. Should only contain one of: ${R.join(", ")}, instead found ${t.join(", ")}`);return t[0]}(e.insert);if(!t)throw Error("Insert patch missing position");let n=A(e.insert[t]),r=n.pop();return[{path:n,op:{type:"insert",position:t,referenceItem:r,items:e.insert.items}}]}(t)]}}throw Error(`Unknown mutation: ${JSON.stringify(e)}`)}let R=["before","replace","after"];function L(e){return D(e)}function N(e){return e.flatMap(L)}function D(e){if("create"===e.type||"createIfNotExists"===e.type||"createOrReplace"===e.type)return{[e.type]:e.document};if("delete"===e.type)return{delete:{id:e.id}};let t=e.options?.ifRevision;return e.patches.map(n=>({patch:{id:e.id,...t&&{ifRevisionID:t},...function(e){let{path:t,op:n}=e;if("unset"===n.type)return{unset:[T(t)]};if("insert"===n.type)return{insert:{[n.position]:T([...t,n.referenceItem]),items:n.items}};if("diffMatchPatch"===n.type)return{diffMatchPatch:{[T(t)]:n.value}};if("inc"===n.type)return{inc:{[T(t)]:n.amount}};if("dec"===n.type)return{dec:{[T(t)]:n.amount}};if("set"===n.type||"setIfMissing"===n.type)return{[n.type]:{[T(t)]:n.value}};if("truncate"===n.type){let e=[n.startIndex,"number"==typeof n.endIndex?n.endIndex:""].join(":");return{unset:[`${T(t)}[${e}]`]}}if("upsert"===n.type)return{unset:n.items.map(e=>T([...t,{_key:e._key}])),insert:{[n.position]:T([...t,n.referenceItem]),items:n.items}};if("assign"===n.type)return{set:Object.fromEntries(Object.keys(n.value).map(e=>[T(t.concat(e)),n.value[e]]))};if("unassign"===n.type)return{unset:n.keys.map(e=>T(t.concat(e)))};if("replace"===n.type)return{insert:{replace:T(t.concat(n.referenceItem)),items:n.items}};if("remove"===n.type)return{unset:[T(t.concat(n.referenceItem))]};throw Error(`Unknown operation type ${n.type}`)}(n)}}))}function z(e){return Array.isArray(e)?e:[e]}var U=Object.freeze({__proto__:null,decode:function(e){return P(e)},decodeAll:function(e){return e.map(P)},encode:L,encodeAll:N,encodeMutation:D,encodeTransaction:function(e){return{transactionId:e.id,mutations:N(e.mutations)}}});function V(e,t,n){return{type:"insert",referenceItem:n,position:t,items:z(e)}}function F(e,t){return{type:"truncate",startIndex:e,endIndex:t}}function Y(e){return{type:"remove",referenceItem:e}}function W(e,t){return{path:"string"==typeof e?A(e):e,op:t}}var q=n(40609);let B=(0,q.H6)(),G=B,H=new Set;var X=n(28423);let J=/_key\s*==\s*['"](.*)['"]/,K=/^\d*:\d*$/;function Z(e){return"number"==typeof e||"string"==typeof e&&/^\[\d+\]$/.test(e)}function Q(e){return"string"==typeof e?J.test(e.trim()):"object"==typeof e&&"_key"in e}let ee=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,et=/_key\s*==\s*['"](.*)['"]/;function en(e,t,n){let r="string"==typeof t?function(e){if("string"!=typeof e)throw Error("Path is not a string");let t=e.match(ee);if(!t)throw Error("Invalid path string");return t.map(er)}(t):t;if(!Array.isArray(r))throw Error("Path must be an array or a string");let i=e;for(let e=0;e<r.length;e++){let t=r[e];if(Z(t)){if(!Array.isArray(i))return n;i=i[t]}if(Q(t)){if(!Array.isArray(i))return n;i=i.find(e=>e._key===t._key)}if("string"==typeof t&&(i="object"==typeof i&&null!==i?i[t]:void 0),typeof i>"u")return n}return i}function er(e){return Z(e)?Number(e.replace(/[^\d]/g,"")):Q(e)?{_key:e.match(et)[1]}:!function(e){if("string"==typeof e&&K.test(e))return!0;if(!Array.isArray(e)||2!==e.length)return!1;let[t,n]=e;return("number"==typeof t||""===t)&&("number"==typeof n||""===n)}(e)?e:function(e){let[t,n]=e.split(":").map(e=>""===e?e:Number(e));return[t,n]}(e)}function ei(){return(0,d.useSyncExternalStore)(es,ea,eo)}function eo(){return B}function ea(){return G}function es(e){return H.add(e),()=>H.delete(e)}function eu(e,t){let n;return(...r)=>{clearTimeout(n),n=setTimeout(()=>{e.apply(e,r)},t)}}function el(e,t){let n=(0,c.Fk)(),r=(0,c.v$)();if(t===B||!n&&!r)throw Error("The `useDocuments` hook cannot be used in this context");let i=I(e),o=S(e),a=t.getSnapshot().context?.documents,s=a?.[i],u=a?.[o],l=s||u;if(!l)throw Error(`Document "${e}" not found`);let d=s.getSnapshot().context?.local||u.getSnapshot().context?.local,p=new Promise(e=>{if(d)e(d);else{let t=l.on("ready",n=>{let{snapshot:r}=n;e(r||null),t.unsubscribe()})}});return{draftDoc:s,draftId:i,getSnapshot:()=>p,publishedDoc:u,publishedId:o,get snapshot(){if(!d)throw Error(`Snapshot for document "${e}" not found`);return d}}}function ec(){let e,t,n,r=(0,l.c)(7),i=ei();r[0]!==i?(e=e=>({id:e,commit:()=>{let{draftDoc:t}=el(e,i);t.send({type:"submit"})},get:t=>{let{snapshot:n}=el(e,i);return t?en(n,t):n},getSnapshot:function(e,t){let{getSnapshot:n}=el(e,t);return n}(e,i),patch:async(t,n)=>{let r=el(e,i),{draftDoc:o,draftId:a,getSnapshot:s,publishedId:u}=r,{commit:l=!0}=n||{},c=await ("function"==typeof t?t({draftId:a,publishedId:u,get snapshot(){return r.snapshot},getSnapshot:s}):t),d=await s();if(!d)throw Error(`Snapshot for document "${e}" not found`);o.send({type:"mutate",mutations:[{type:"createIfNotExists",document:{...d,_id:a}},{type:"patch",id:a,patches:z(c),...{}}]}),l&&("object"==typeof l&&"debounce"in l?eu(()=>o.send({type:"submit"}),l.debounce)():o.send({type:"submit"}))}}),r[0]=i,r[1]=e):e=r[1];let o=e;r[2]!==i?(t=(e,t,n)=>{let{draftDoc:r}=el(e,i),{commit:o}=n||{},a=void 0===o||o;r.send({type:"mutate",mutations:t}),a&&("object"==typeof a&&"debounce"in a?eu(()=>r.send({type:"submit"}),a.debounce)():r.send({type:"submit"}))},r[2]=i,r[3]=t):t=r[3];let a=t;return r[4]!==o||r[5]!==a?(n={getDocument:o,mutateDocument:a},r[4]=o,r[5]=a,r[6]=n):n=r[6],n}let ed=(()=>{let e;return()=>{if(e)return e;e=[];for(let t=0;t<256;++t)e[t]=(t+256).toString(16).slice(1);return e}})();function ep(e){let t=ed();return(function(e=16){let t=new Uint8Array(e);return(0,X.A)(t),t})(e).reduce((e,n)=>e+t[n],"").slice(0,e)}function ef(e){let t,n,r="string"==typeof e?e:e.path,i=r.lastIndexOf("."),o=r.substring(i+1,r.length);if(!o.indexOf("["))throw Error("Invalid path: not an array");let a=r.lastIndexOf("["),s=r.substring(0,a);if(o.includes("_key")){let e=o.indexOf('"')+1,r=o.indexOf('"',e);t=o.substring(e,r),n=!0}else{let e=o.indexOf("[")+1,r=o.indexOf("]",e);t=o.substring(e,r),n=!1}if(!s||!t)throw Error("Invalid path");return{path:s,key:t,hasExplicitKey:n}}async function em(e,t,n){if(!e.type)throw Error("Node type is missing");let{path:r,key:i}=ef(e),o=await t.getSnapshot(),a=en(o,r),s=en(o,e.path),u=a.findIndex(e=>e._key===i),l=-1,c="before";if("first"===n){if(0===u)return[];l=0,c="before"}else if("last"===n){if(u===a.length-1)return[];l=-1,c="after"}else if("next"===n){if(u===a.length-1)return[];l=u,c="after"}else if("previous"===n){if(0===u)return[];l=u-1,c="before"}return[W(r,F(u,u+1)),W(r,V(s,c,l))]}var ey=n(93261),eh=n(79813);let ev=(0,eh.FsL)((0,eh.YjP)(),(0,eh.BpQ)(1)),eg=(0,eh.lqM)(ev),eb=(0,eh.Ikc)({baseUrl:ev,dataset:eg,id:ev,path:ev,projectId:eg,tool:eg,type:eg,workspace:eg}),ew=/^([\w-]+):(0|[1-9][0-9]*)$/,ex=/^([\w-]+):([0-9]+),([0-9]+)$/,eE=/^([\w-]+):([\w-]+)$/,e_=(0,eh.FsL)((0,eh.YjP)(),(0,eh.BpQ)(1)),ej=(0,eh.Ikc)({origin:e_,href:e_,data:(0,eh.lqM)((0,eh.g1P)((0,eh.YjP)(),(0,eh.L5J)()))});function ek(e){let t=(0,eh.xLC)(eb,e);if(t.success)return t.output;let n=(0,eh.xLC)(ej,e);if(n.success)try{let e=new URL(n.output.href,typeof document>"u"?"https://example.com":location.origin);return e.searchParams.size>0?(0,eh.qgA)(eb,Object.fromEntries(e.searchParams.entries())):n.output}catch(e){return console.error("Failed to parse sanity node",e),n.output}}var eI={0:8203,1:8204,2:8205,3:8290,4:8291,5:8288,6:65279,7:8289,8:119155,9:119156,a:119157,b:119158,c:119159,d:119160,e:119161,f:119162},eS={0:8203,1:8204,2:8205,3:65279},eM=[,,,,].fill(String.fromCodePoint(eS[0])).join(""),e$=Object.fromEntries(Object.entries(eS).map(e=>e.reverse())),eA=Object.fromEntries(Object.entries(eI).map(e=>e.reverse())),eC=`${Object.values(eI).map(e=>`\\u{${e.toString(16)}}`).join("")}`,eO=RegExp(`[${eC}]{4,}`,"gu");let eT=[];for(let e=0;e<256;++e)eT.push((e+256).toString(16).slice(1));let eP=new Uint8Array(16);var eR={randomUUID:"u">typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto)};function eL(e,t,n){if(eR.randomUUID&&!e)return eR.randomUUID();let i=(e=e||{}).random??e.rng?.()??function(){if(!r){if(typeof crypto>"u"||!crypto.getRandomValues)throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");r=crypto.getRandomValues.bind(crypto)}return r(eP)}();if(i.length<16)throw Error("Random bytes length must be >= 16");return i[6]=15&i[6]|64,i[8]=63&i[8]|128,function(e,t=0){return(eT[e[t+0]]+eT[e[t+1]]+eT[e[t+2]]+eT[e[t+3]]+"-"+eT[e[t+4]]+eT[e[t+5]]+"-"+eT[e[t+6]]+eT[e[t+7]]+"-"+eT[e[t+8]]+eT[e[t+9]]+"-"+eT[e[t+10]]+eT[e[t+11]]+eT[e[t+12]]+eT[e[t+13]]+eT[e[t+14]]+eT[e[t+15]]).toLowerCase()}(i)}function eN(e){let t=e.getBoundingClientRect();return{x:t.x+scrollX,y:t.y+scrollY,w:t.width,h:t.height}}function eD(e,t,n){return"x"===n?{x:e.x+t,y:e.y,w:e.w-2*t,h:e.h}:{x:e.x,y:e.y+t,w:e.w,h:e.h-2*t}}function ez(e,t){return e.x===t.x&&e.y===t.y&&e.w===t.w&&e.h===t.h}function eU(e,t){let n=e.x-t.x,r=e.y-t.y;return Math.sqrt(n*n+r*r)}function eV(e,t,n){let r,i,o={x:e.x1,y:e.y1};if(t.some(e=>(function(e,t){let n=e.x>=t.x&&e.x<=t.x+t.w,r=e.y>=t.y&&e.y<=t.y+t.h;return n&&r})(o,eD(e,Math.min(e.w,e.h)/10,"horizontal"===n?"x":"y"))))return null;for(let a of t){let t=function(e,t){let n=[{x1:t.x,y1:t.y,x2:t.x+t.w,y2:t.y},{x1:t.x+t.w,y1:t.y,x2:t.x+t.w,y2:t.y+t.h},{x1:t.x+t.w,y1:t.y+t.h,x2:t.x,y2:t.y+t.h},{x1:t.x,y1:t.y+t.h,x2:t.x,y2:t.y}],r=[];for(let t=0;t<n.length;t++){let i=function(e,t){let{x1:n,y1:r,x2:i,y2:o}=e,{x1:a,y1:s,x2:u,y2:l}=t;if(n===i&&r===o||a===u&&s===l)return!1;let c=(l-s)*(i-n)-(u-a)*(o-r);if(0===c)return!1;let d=((u-a)*(r-s)-(l-s)*(n-a))/c,p=((i-n)*(r-s)-(o-r)*(n-a))/c;return!(d<0)&&!(d>1)&&!(p<0)&&!(p>1)&&{x:n+d*(i-n),y:r+d*(o-r)}}(e,n[t]);if(i){let e=!1;for(let t=0;t<r.length;t++)r[t].x===i.x&&r[t].y===i.y&&(e=!0);e||r.push(i)}}return 0!==r.length&&r.sort((t,n)=>eU(t,{x:e.x1,y:e.y1})-eU(n,{x:e.x1,y:e.y1}))}(e,eD(a,Math.min(a.w,a.h)/10,"horizontal"===n?"x":"y"));if(t){let e=t[0];r?eU(o,e)<eU(o,r)&&(r=e,i=a):(r=e,i=a)}}return i||null}function eF(e,t,n){let{x:r,y:i,w:o,h:a}=e,{x:s,y:u}=n;return{x:s+(r-s)*t,y:u+(i-u)*t,w:o*t,h:a*t}}function eY(e){let t=Math.max(0,Math.min(...e.map(e=>e.y))),n=Math.min(document.body.scrollHeight,Math.max(...e.map(e=>e.y+e.h)));return{min:t,max:n,height:n-t}}function eW(e,t){return t.find(t=>ez(eN(t.elements.element),e))?.sanity}function eq(e,t,n){return Object.values(t).every(e=>null===e)?null:"horizontal"===n?{left:t.left?{rect:t.left,sanity:eW(t.left,e)}:null,right:t.right?{rect:t.right,sanity:eW(t.right,e)}:null}:{top:t.top?{rect:t.top,sanity:eW(t.top,e)}:null,bottom:t.bottom?{rect:t.bottom,sanity:eW(t.bottom,e)}:null}}function eB(e){let t=document.body.getBoundingClientRect();return{x:Math.max(t.x,Math.min(e.clientX,t.x+t.width)),y:e.clientY+window.scrollY}}function eG(e,t,n){let r=eN(t),i=[...t.querySelectorAll(":where(h1, h2, h3, h4, p, a, img, span, button):not(:has(*))")];e.x<=r.x&&(e.x=r.x),e.x>=r.x+r.w&&(e.x=r.x+r.w),e.y>=r.y+r.h&&(e.y=r.y+r.h),e.y<=r.y&&(e.y=r.y);let o=i.map(e=>{let t=eF(eN(e),n,{x:r.x,y:r.y});return{x:t.x-r.x,y:t.y-r.y,w:t.w,h:t.h,tagName:e.tagName}});return{offsetX:(r.x-e.x)*n,offsetY:(r.y-e.y)*n,w:r.w*n,h:r.h*n,maxWidth:r.w*n*.75,childRects:o}}async function eH(e,t,n,r,i){return new Promise(o=>{e.addEventListener("transitionend",()=>{setTimeout(()=>{r({type:"overlay/dragEndMinimapTransition"})},2*i),o()},{once:!0}),r({type:"overlay/dragStartMinimapTransition"}),r({type:"overlay/dragToggleMinimap",display:!0}),document.body.style.overflow="hidden",document.body.style.height="100%",document.documentElement.style.overflow="initial",document.documentElement.style.height="100%",setTimeout(()=>{e.style.transformOrigin="50% 0px",e.style.transition="transform 150ms ease",e.style.transform=`translate3d(0px, ${-n+scrollY}px, 0px) scale(${t})`},25)})}function eX(e){let t=function(e){let t=Math.max(0,Math.min(...e.map(e=>e.x))),n=Math.min(document.body.offsetWidth,Math.max(...e.map(e=>e.x+e.w)));return{min:t,max:n,width:n-t}}(e),n=eY(e),r=t.min>8&&t.min+t.width<=window.innerWidth-8,i=n.min>8&&n.min+n.height<=document.body.scrollHeight-8,o=r&&i;return{x:o?t.min-8:t.min,y:o?n.min-8:n.min,w:o?t.width+16:t.width,h:o?n.height+16:n.height}}async function eJ(e,t,n,r,i,o){return new Promise(a=>{if(1===new DOMMatrix(window.getComputedStyle(t).transform).a)return;let s=n-window.innerHeight,u=scrollY;(e-=window.innerHeight/2)<0&&(e=0),t.addEventListener("transitionend",()=>{t.style.transition="none",t.style.transform="none",scrollTo({top:e,behavior:"instant"}),setTimeout(()=>{r({type:"overlay/dragEndMinimapTransition"}),r({type:"overlay/dragToggleMinimap",display:!1})},2*i),a()},{once:!0}),r({type:"overlay/dragStartMinimapTransition"}),t.style.transform=`translateY(${Math.max(u-e,-s+u)}px) scale(1)`,o&&(document.body.style.overflow=o.body.overflow,document.body.style.height=o.body.height,document.documentElement.style.overflow=o.documentElement.overflow,document.documentElement.style.height=o.documentElement.height)})}let eK=!1,eZ={y:0},eQ={x:0,y:0},e0=typeof document>"u"?0:document.documentElement.scrollHeight,e1=null,e2=e=>e instanceof HTMLElement||e instanceof SVGElement,e3=e=>e&&e2(e)?e.dataset?.sanityOverlayElement?e:e3(e.parentElement):null;function e4(e){return eO.lastIndex=0,eO.test(e)}function e5(e,t=!1){return e4(e)?function(e,t=!1){try{let n=function(e){let t=e.match(eO);if(t)return function(e,t=!1){let n=Array.from(e);if(n.length%2==0){if(n.length%4||!e.startsWith(eM))return function(e,t){var n;let r=[];for(let t=.5*e.length;t--;){let n=`${eA[e[2*t].codePointAt(0)]}${eA[e[2*t+1].codePointAt(0)]}`;r.unshift(String.fromCharCode(parseInt(n,16)))}let i=[],o=[r.join("")],a=10;for(;o.length;){let e=o.shift();try{if(i.push(JSON.parse(e)),t)break}catch(r){if(!a--)throw r;let t=+(null==(n=r.message.match(/\sposition\s(\d+)$/))?void 0:n[1]);if(!t)throw r;o.unshift(e.substring(0,t),e.substring(t))}}return i}(n,t)}else throw Error("Encoded data has invalid length");let r=[];for(let e=.25*n.length;e--;){let t=n.slice(4*e,4*e+4).map(e=>e$[e.codePointAt(0)]).join("");r.unshift(String.fromCharCode(parseInt(t,4)))}if(t){r.shift();let e=r.indexOf("\0");return -1===e&&(e=r.length),[JSON.parse(r.slice(0,e).join(""))]}return r.join("").split("\0").filter(Boolean).map(e=>JSON.parse(e))}(t[0],!0)[0]}(e);return n&&"sanity.io"===n.origin?(t&&(n.href=n.href?.replace(".alt","")),n):null}catch(t){return console.error("Failed to decode stega for string: ",e,"with the original error: ",t),null}}(e,t):null}function e6(e){return"path"in e}function e9(e){if(!e.length||!e.map(e=>e6(e)).every((e,t,n)=>e===n[0]))return;if(!e6(e[0]))return e[0];let t=e.filter(e6),n=e[0],r=["projectId","dataset","id","baseUrl","workspace","tool"];for(let e=1;e<t.length;e++){let i=t[e];if(r.some(e=>i[e]!==n?.[e])){n=void 0;break}n={...n,path:function(e,t){let n=e.split("."),r=t.split("."),i=Math.min(n.length,r.length);return n=n.slice(0,i).reverse(),r=r.slice(0,i).reverse(),n.reduce((e,t,n)=>t===r[n]?[...e,t]:[],[]).reverse().join(".")}(n.path,i.path)}}return n}function e8(e){let t=e.lastIndexOf(".");return e.substring(t,e.length).includes("[")}function e7(e){if(!e8(e))return null;let t=e.split(".");return t[t.length-1]=t[t.length-1].replace(/\[.*?\]/g,"[]"),t.join(".")}function te(e,t){return!!e8(e.path)&&!!e8(t.path)&&e7(e.path)===e7(t.path)}function tt(e,t,n,r){if(!e.getAttribute("data-sanity")||e.getAttribute("data-sanity-drag-disable")||!t||!e6(t)||!e8(t.path))return null;let i=e.getAttribute("data-sanity-drag-group"),o=[...n].reduce((e,n)=>{let o=r.get(n),a=n.getAttribute("data-sanity-drag-disable"),s=n.getAttribute("data-sanity-drag-group"),u=null!==n.getAttribute("data-sanity");return o?.sanity&&!a&&e6(o.sanity)&&te(t,o.sanity)&&(null===i||i===s)&&u&&e.push(o),e},[]);return o.length<=1?null:o}let tn=(0,d.createContext)(null);var tr=n(90886),ti=n(96241);function to(e){if(!e)return(0,u.jsx)(ti.XRf,{});if("string"===e.type)return(0,u.jsx)(ti.H3M,{});if("number"===e.type)return(0,u.jsx)(ti.bZn,{});let{value:t}=e;if("icon"in e&&e.icon)return(0,u.jsx)("div",{dangerouslySetInnerHTML:{__html:e.icon}});let{type:n}=t;if("string"===n)return(0,u.jsx)(ti.H3M,{});if("boolean"===n)return(0,u.jsx)(ti.Dee,{});if("number"===n)return(0,u.jsx)(ti.bZn,{});if("array"===n||"union"===n)return(Array.isArray(t.of)?t.of:[t.of]).some(e=>"name"in e&&"block"===e.name)?(0,u.jsx)(ti.a1,{}):(0,u.jsx)(ti.Ss4,{});if("object"===n){if("image"===e.name)return(0,u.jsx)(ti.xfq,{});if("block"===e.name)return(0,u.jsx)(ti.H3M,{})}return(0,u.jsx)(ti.XRf,{})}let ta=(0,$.AH)`
  overflow-y: scroll;
  overscroll-behavior: contain;
  -ms-overflow-style: none;
  scrollbar-width: none;

  &:before {
    content: '';
    display: block;
    height: calc(100% + 1px);
    position: absolute;
    top: 0;
    width: 100%;
    z-index: -1;
  }
`,ts=$.I4.div`
  height: 100%;
  inset: 0;
  pointer-events: all;
  position: fixed;
  width: 100%;
  display: flex;
  justify-content: center;
  align-items: center;

  ${e=>e.$blockScroll&&ta}
`,tu=$.I4.div`
  background: transparent;
  height: 100%;
  inset: 0;
  position: absolute;
  width: 100%;
`,tl=e=>{let t,n=(0,l.c)(2);return n[0]!==e?(t=(0,u.jsx)(M.ZL,{children:(0,u.jsx)(tc,{...e})}),n[0]=e,n[1]=t):t=n[1],t},tc=e=>{let t,n,r=(0,l.c)(7),{children:i,onDismiss:o,setBoundaryElement:a,blockScroll:s}=e,c=void 0===s||s;return r[0]!==o?(t=(0,u.jsx)(tu,{onMouseDownCapture:()=>{o?.()}}),r[0]=o,r[1]=t):t=r[1],r[2]!==c||r[3]!==i||r[4]!==a||r[5]!==t?(n=(0,u.jsxs)(ts,{"data-sanity-overlay-element":!0,ref:a,onClick:td,$blockScroll:c,children:[t,i]}),r[2]=c,r[3]=i,r[4]=a,r[5]=t,r[6]=n):n=r[6],n};function td(e){e.stopPropagation()}function tp(e){return{type:"log",name:e.name,version:e.version,description:e.description,maxSampleRate:e.maxSampleRate,schema:void 0}}let tf={"Visual Editing Drag Sequence Completed":tp({name:"Visual Editing Drag Sequence Completed",description:"An array is successfully reordered using drag and drop.",version:1}),"Visual Editing Drag Minimap Enabled":tp({name:"Visual Editing Drag Minimap Enabled",description:"The zoomed-out minimap view is enabled during a drag sequence.",version:1}),"Visual Editing Context Menu Item Removed":tp({name:"Visual Editing Context Menu Item Removed",description:"An item is removed using the Context Menu.",version:1}),"Visual Editing Context Menu Item Duplicated":tp({name:"Visual Editing Context Menu Item Duplicated",description:"An item is duplicated using the Context Menu.",version:1}),"Visual Editing Context Menu Item Moved":tp({name:"Visual Editing Context Menu Item Moved",description:"An item is moved using the Context Menu.",version:1}),"Visual Editing Context Menu Item Inserted":tp({name:"Visual Editing Context Menu Item Inserted",description:"An item is inserted using the Context Menu.",version:1}),"Visual Editing Insert Menu Item Inserted":tp({name:"Visual Editing Insert Menu Item Inserted",description:"An item is inserted using the Insert Menu.",version:1}),"Visual Editing Overlay Clicked":tp({name:"Visual Editing Overlay Clicked",description:"An Overlay is clicked.",version:1})},tm=(0,d.createContext)(void 0);function ty(){let e=(0,d.useContext)(tm);if(!e)throw Error("Telemetry context is missing");return e}let th={"insert-menu.filter.all-items":"All","insert-menu.search.no-results":"No results","insert-menu.search.placeholder":"Filter types…","insert-menu.toggle-grid-view.tooltip":"Toggle grid view","insert-menu.toggle-list-view.tooltip":"Toggle list view"},tv=e=>{let t,n,r,i,o=(0,l.c)(11),{node:a,onSelect:s}=e;o[0]!==a.options?.insertMenu?(t=a.options?.insertMenu||{},o[0]=a.options?.insertMenu,o[1]=t):t=o[1];let c=t;o[2]!==c.views?(n=c.views?.map(tg),o[2]=c.views,o[3]=n):n=o[3];let d=n;return o[4]!==a.of?(r=a.of.map(tb),o[4]=a.of,o[5]=r):r=o[5],o[6]!==c||o[7]!==s||o[8]!==r||o[9]!==d?(i=(0,u.jsx)(tr.Z,{...c,labels:th,schemaTypes:r,onSelect:s,views:d}),o[6]=c,o[7]=s,o[8]=r,o[9]=d,o[10]=i):i=o[10],i};function tg(e){return"grid"===e.name?{...e,previewImageUrl:t=>e.previewImageUrls?.[t]}:e}function tb(e){return{...e,icon:to(e)}}let tw=e=>{let t,n,r,i,o,a=(0,l.c)(10);return a[0]!==e?({children:t,style:r,...n}=e,a[0]=e,a[1]=t,a[2]=n,a[3]=r):(t=a[1],n=a[2],r=a[3]),a[4]!==r?(i={...r,pointerEvents:"all"},a[4]=r,a[5]=i):i=a[5],a[6]!==t||a[7]!==n||a[8]!==i?(o=(0,u.jsx)("div",{style:i,"data-sanity-overlay-element":!0,...n,children:t}),a[6]=t,a[7]=n,a[8]=i,a[9]=o):o=a[9],o};var tx=n(59452),tE=n(26719),t_=n(61332),tj=n(48810),tk=n(37305),tI=n(31536),tS=n(32466),tM=n(37121),t$="object"==typeof global&&global&&global.Object===Object&&global,tA="object"==typeof self&&self&&self.Object===Object&&self,tC=t$||tA||Function("return this")(),tO=tC.Symbol,tT=Object.prototype,tP=tT.hasOwnProperty,tR=tT.toString,tL=tO?tO.toStringTag:void 0;let tN=function(e){var t=tP.call(e,tL),n=e[tL];try{e[tL]=void 0;var r=!0}catch(e){}var i=tR.call(e);return r&&(t?e[tL]=n:delete e[tL]),i};var tD=Object.prototype.toString,tz=tO?tO.toStringTag:void 0;let tU=function(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":tz&&tz in Object(e)?tN(e):tD.call(e)},tV=function(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)},tF=function(e){if(!tV(e))return!1;var t=tU(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t};var tY=tC["__core-js_shared__"],tW=function(){var e=/[^.]+$/.exec(tY&&tY.keys&&tY.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}(),tq=Function.prototype.toString;let tB=function(e){if(null!=e){try{return tq.call(e)}catch(e){}try{return e+""}catch(e){}}return""};var tG=/^\[object .+?Constructor\]$/,tH=Object.prototype,tX=Function.prototype.toString,tJ=tH.hasOwnProperty,tK=RegExp("^"+tX.call(tJ).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");let tZ=function(e){return!!tV(e)&&(!tW||!(tW in e))&&(tF(e)?tK:tG).test(tB(e))},tQ=function(e,t){var n=null==e?void 0:e[t];return tZ(n)?n:void 0};var t0=function(){try{var e=tQ(Object,"defineProperty");return e({},"",{}),e}catch(e){}}();let t1=function(e,t,n){"__proto__"==t&&t0?t0(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n},t2=function(e,t,n,r){for(var i=-1,o=null==e?0:e.length;++i<o;){var a=e[i];t(r,a,n(a),e)}return r},t3=function(e,t,n){for(var r=-1,i=Object(e),o=n(e),a=o.length;a--;){var s=o[++r];if(!1===t(i[s],s,i))break}return e},t4=function(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r},t5=function(e){return null!=e&&"object"==typeof e},t6=function(e){return t5(e)&&"[object Arguments]"==tU(e)};var t9=Object.prototype,t8=t9.hasOwnProperty,t7=t9.propertyIsEnumerable,ne=t6(function(){return arguments}())?t6:function(e){return t5(e)&&t8.call(e,"callee")&&!t7.call(e,"callee")},nt=Array.isArray,nn="object"==typeof exports&&exports&&!exports.nodeType&&exports,nr=nn&&"object"==typeof module&&module&&!module.nodeType&&module,ni=nr&&nr.exports===nn?tC.Buffer:void 0;let no=(ni?ni.isBuffer:void 0)||function(){return!1};var na=/^(?:0|[1-9]\d*)$/;let ns=function(e,t){var n=typeof e;return!!(t=null==t?0x1fffffffffffff:t)&&("number"==n||"symbol"!=n&&na.test(e))&&e>-1&&e%1==0&&e<t},nu=function(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=0x1fffffffffffff};var nl={};nl["[object Float32Array]"]=nl["[object Float64Array]"]=nl["[object Int8Array]"]=nl["[object Int16Array]"]=nl["[object Int32Array]"]=nl["[object Uint8Array]"]=nl["[object Uint8ClampedArray]"]=nl["[object Uint16Array]"]=nl["[object Uint32Array]"]=!0,nl["[object Arguments]"]=nl["[object Array]"]=nl["[object ArrayBuffer]"]=nl["[object Boolean]"]=nl["[object DataView]"]=nl["[object Date]"]=nl["[object Error]"]=nl["[object Function]"]=nl["[object Map]"]=nl["[object Number]"]=nl["[object Object]"]=nl["[object RegExp]"]=nl["[object Set]"]=nl["[object String]"]=nl["[object WeakMap]"]=!1;var nc="object"==typeof exports&&exports&&!exports.nodeType&&exports,nd=nc&&"object"==typeof module&&module&&!module.nodeType&&module,np=nd&&nd.exports===nc&&t$.process,nf=function(){try{var e=nd&&nd.require&&nd.require("util").types;if(e)return e;return np&&np.binding&&np.binding("util")}catch(e){}}(),nm=nf&&nf.isTypedArray,ny=nm?function(e){return nm(e)}:function(e){return t5(e)&&nu(e.length)&&!!nl[tU(e)]},nh=Object.prototype.hasOwnProperty;let nv=function(e,t){var n=nt(e),r=!n&&ne(e),i=!n&&!r&&no(e),o=!n&&!r&&!i&&ny(e),a=n||r||i||o,s=a?t4(e.length,String):[],u=s.length;for(var l in e)(t||nh.call(e,l))&&!(a&&("length"==l||i&&("offset"==l||"parent"==l)||o&&("buffer"==l||"byteLength"==l||"byteOffset"==l)||ns(l,u)))&&s.push(l);return s};var ng=Object.prototype;let nb=function(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||ng)};var nw=(a=Object.keys,s=Object,function(e){return a(s(e))}),nx=Object.prototype.hasOwnProperty;let nE=function(e){if(!nb(e))return nw(e);var t=[];for(var n in Object(e))nx.call(e,n)&&"constructor"!=n&&t.push(n);return t},n_=function(e){return null!=e&&nu(e.length)&&!tF(e)},nj=function(e){return n_(e)?nv(e):nE(e)};var nk=(i=function(e,t){return e&&t3(e,t,nj)},function(e,t){if(null==e)return e;if(!n_(e))return i(e,t);for(var n=e.length,r=-1,o=Object(e);++r<n&&!1!==t(o[r],r,o););return e});let nI=function(e,t,n,r){return nk(e,function(e,i,o){t(r,e,n(e),o)}),r},nS=function(e,t){return e===t||e!=e&&t!=t},nM=function(e,t){for(var n=e.length;n--;)if(nS(e[n][0],t))return n;return -1};var n$=Array.prototype.splice;function nA(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}nA.prototype.clear=function(){this.__data__=[],this.size=0},nA.prototype.delete=function(e){var t=this.__data__,n=nM(t,e);return!(n<0)&&(n==t.length-1?t.pop():n$.call(t,n,1),--this.size,!0)},nA.prototype.get=function(e){var t=this.__data__,n=nM(t,e);return n<0?void 0:t[n][1]},nA.prototype.has=function(e){return nM(this.__data__,e)>-1},nA.prototype.set=function(e,t){var n=this.__data__,r=nM(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this};var nC=tQ(tC,"Map"),nO=tQ(Object,"create"),nT=Object.prototype.hasOwnProperty,nP=Object.prototype.hasOwnProperty;function nR(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}nR.prototype.clear=function(){this.__data__=nO?nO(null):{},this.size=0},nR.prototype.delete=function(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=!!t,t},nR.prototype.get=function(e){var t=this.__data__;if(nO){var n=t[e];return"__lodash_hash_undefined__"===n?void 0:n}return nT.call(t,e)?t[e]:void 0},nR.prototype.has=function(e){var t=this.__data__;return nO?void 0!==t[e]:nP.call(t,e)},nR.prototype.set=function(e,t){var n=this.__data__;return this.size+=+!this.has(e),n[e]=nO&&void 0===t?"__lodash_hash_undefined__":t,this};let nL=function(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e},nN=function(e,t){var n=e.__data__;return nL(t)?n["string"==typeof t?"string":"hash"]:n.map};function nD(e){var t=-1,n=null==e?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}function nz(e){var t=this.__data__=new nA(e);this.size=t.size}function nU(e){var t=-1,n=null==e?0:e.length;for(this.__data__=new nD;++t<n;)this.add(e[t])}nD.prototype.clear=function(){this.size=0,this.__data__={hash:new nR,map:new(nC||nA),string:new nR}},nD.prototype.delete=function(e){var t=nN(this,e).delete(e);return this.size-=!!t,t},nD.prototype.get=function(e){return nN(this,e).get(e)},nD.prototype.has=function(e){return nN(this,e).has(e)},nD.prototype.set=function(e,t){var n=nN(this,e),r=n.size;return n.set(e,t),this.size+=+(n.size!=r),this},nz.prototype.clear=function(){this.__data__=new nA,this.size=0},nz.prototype.delete=function(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n},nz.prototype.get=function(e){return this.__data__.get(e)},nz.prototype.has=function(e){return this.__data__.has(e)},nz.prototype.set=function(e,t){var n=this.__data__;if(n instanceof nA){var r=n.__data__;if(!nC||r.length<199)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new nD(r)}return n.set(e,t),this.size=n.size,this},nU.prototype.add=nU.prototype.push=function(e){return this.__data__.set(e,"__lodash_hash_undefined__"),this},nU.prototype.has=function(e){return this.__data__.has(e)};let nV=function(e,t){for(var n=-1,r=null==e?0:e.length;++n<r;)if(t(e[n],n,e))return!0;return!1},nF=function(e,t,n,r,i,o){var a=1&n,s=e.length,u=t.length;if(s!=u&&!(a&&u>s))return!1;var l=o.get(e),c=o.get(t);if(l&&c)return l==t&&c==e;var d=-1,p=!0,f=2&n?new nU:void 0;for(o.set(e,t),o.set(t,e);++d<s;){var m=e[d],y=t[d];if(r)var h=a?r(y,m,d,t,e,o):r(m,y,d,e,t,o);if(void 0!==h){if(h)continue;p=!1;break}if(f){if(!nV(t,function(e,t){if(!f.has(t)&&(m===e||i(m,e,n,r,o)))return f.push(t)})){p=!1;break}}else if(!(m===y||i(m,y,n,r,o))){p=!1;break}}return o.delete(e),o.delete(t),p};var nY=tC.Uint8Array;let nW=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e,r){n[++t]=[r,e]}),n},nq=function(e){var t=-1,n=Array(e.size);return e.forEach(function(e){n[++t]=e}),n};var nB=tO?tO.prototype:void 0,nG=nB?nB.valueOf:void 0;let nH=function(e,t,n,r,i,o,a){switch(n){case"[object DataView]":if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)break;e=e.buffer,t=t.buffer;case"[object ArrayBuffer]":if(e.byteLength!=t.byteLength||!o(new nY(e),new nY(t)))break;return!0;case"[object Boolean]":case"[object Date]":case"[object Number]":return nS(+e,+t);case"[object Error]":return e.name==t.name&&e.message==t.message;case"[object RegExp]":case"[object String]":return e==t+"";case"[object Map]":var s=nW;case"[object Set]":var u=1&r;if(s||(s=nq),e.size!=t.size&&!u)break;var l=a.get(e);if(l)return l==t;r|=2,a.set(e,t);var c=nF(s(e),s(t),r,i,o,a);return a.delete(e),c;case"[object Symbol]":if(nG)return nG.call(e)==nG.call(t)}return!1},nX=function(e,t){for(var n=-1,r=t.length,i=e.length;++n<r;)e[i+n]=t[n];return e},nJ=function(e,t,n){var r=t(e);return nt(e)?r:nX(r,n(e))},nK=function(e,t){for(var n=-1,r=null==e?0:e.length,i=0,o=[];++n<r;){var a=e[n];t(a,n,e)&&(o[i++]=a)}return o};var nZ=Object.prototype.propertyIsEnumerable,nQ=Object.getOwnPropertySymbols,n0=nQ?function(e){return null==e?[]:nK(nQ(e=Object(e)),function(t){return nZ.call(e,t)})}:function(){return[]};let n1=function(e){return nJ(e,nj,n0)};var n2=Object.prototype.hasOwnProperty;let n3=function(e,t,n,r,i,o){var a=1&n,s=n1(e),u=s.length;if(u!=n1(t).length&&!a)return!1;for(var l=u;l--;){var c=s[l];if(!(a?c in t:n2.call(t,c)))return!1}var d=o.get(e),p=o.get(t);if(d&&p)return d==t&&p==e;var f=!0;o.set(e,t),o.set(t,e);for(var m=a;++l<u;){var y=e[c=s[l]],h=t[c];if(r)var v=a?r(h,y,c,t,e,o):r(y,h,c,e,t,o);if(!(void 0===v?y===h||i(y,h,n,r,o):v)){f=!1;break}m||(m="constructor"==c)}if(f&&!m){var g=e.constructor,b=t.constructor;g!=b&&"constructor"in e&&"constructor"in t&&!("function"==typeof g&&g instanceof g&&"function"==typeof b&&b instanceof b)&&(f=!1)}return o.delete(e),o.delete(t),f};var n4=tQ(tC,"DataView"),n5=tQ(tC,"Promise"),n6=tQ(tC,"Set"),n9=tQ(tC,"WeakMap"),n8="[object Map]",n7="[object Promise]",re="[object Set]",rt="[object WeakMap]",rn="[object DataView]",rr=tB(n4),ri=tB(nC),ro=tB(n5),ra=tB(n6),rs=tB(n9),ru=tU;(n4&&ru(new n4(new ArrayBuffer(1)))!=rn||nC&&ru(new nC)!=n8||n5&&ru(n5.resolve())!=n7||n6&&ru(new n6)!=re||n9&&ru(new n9)!=rt)&&(ru=function(e){var t=tU(e),n="[object Object]"==t?e.constructor:void 0,r=n?tB(n):"";if(r)switch(r){case rr:return rn;case ri:return n8;case ro:return n7;case ra:return re;case rs:return rt}return t});let rl=ru;var rc="[object Arguments]",rd="[object Array]",rp="[object Object]",rf=Object.prototype.hasOwnProperty;let rm=function(e,t,n,r,i,o){var a=nt(e),s=nt(t),u=a?rd:rl(e),l=s?rd:rl(t);u=u==rc?rp:u,l=l==rc?rp:l;var c=u==rp,d=l==rp,p=u==l;if(p&&no(e)){if(!no(t))return!1;a=!0,c=!1}if(p&&!c)return o||(o=new nz),a||ny(e)?nF(e,t,n,r,i,o):nH(e,t,u,n,r,i,o);if(!(1&n)){var f=c&&rf.call(e,"__wrapped__"),m=d&&rf.call(t,"__wrapped__");if(f||m){var y=f?e.value():e,h=m?t.value():t;return o||(o=new nz),i(y,h,n,r,o)}}return!!p&&(o||(o=new nz),n3(e,t,n,r,i,o))},ry=function e(t,n,r,i,o){return t===n||(null!=t&&null!=n&&(t5(t)||t5(n))?rm(t,n,r,i,e,o):t!=t&&n!=n)},rh=function(e,t,n,r){var i=n.length,o=i,a=!r;if(null==e)return!o;for(e=Object(e);i--;){var s=n[i];if(a&&s[2]?s[1]!==e[s[0]]:!(s[0]in e))return!1}for(;++i<o;){var u=(s=n[i])[0],l=e[u],c=s[1];if(a&&s[2]){if(void 0===l&&!(u in e))return!1}else{var d=new nz;if(r)var p=r(l,c,u,e,t,d);if(!(void 0===p?ry(c,l,3,r,d):p))return!1}}return!0},rv=function(e){return e==e&&!tV(e)},rg=function(e){for(var t=nj(e),n=t.length;n--;){var r=t[n],i=e[r];t[n]=[r,i,rv(i)]}return t},rb=function(e,t){return function(n){return null!=n&&n[e]===t&&(void 0!==t||e in Object(n))}},rw=function(e){var t=rg(e);return 1==t.length&&t[0][2]?rb(t[0][0],t[0][1]):function(n){return n===e||rh(n,e,t)}},rx=function(e){return"symbol"==typeof e||t5(e)&&"[object Symbol]"==tU(e)};var rE=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,r_=/^\w*$/;let rj=function(e,t){if(nt(e))return!1;var n=typeof e;return!!("number"==n||"symbol"==n||"boolean"==n||null==e||rx(e))||r_.test(e)||!rE.test(e)||null!=t&&e in Object(t)};function rk(e,t){if("function"!=typeof e||null!=t&&"function"!=typeof t)throw TypeError("Expected a function");var n=function(){var r=arguments,i=t?t.apply(this,r):r[0],o=n.cache;if(o.has(i))return o.get(i);var a=e.apply(this,r);return n.cache=o.set(i,a)||o,a};return n.cache=new(rk.Cache||nD),n}rk.Cache=nD;var rI=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,rS=/\\(\\)?/g,rM=function(e){var t=rk(e,function(e){return 500===n.size&&n.clear(),e}),n=t.cache;return t}(function(e){var t=[];return 46===e.charCodeAt(0)&&t.push(""),e.replace(rI,function(e,n,r,i){t.push(r?i.replace(rS,"$1"):n||e)}),t});let r$=function(e,t){for(var n=-1,r=null==e?0:e.length,i=Array(r);++n<r;)i[n]=t(e[n],n,e);return i};var rA=1/0,rC=tO?tO.prototype:void 0,rO=rC?rC.toString:void 0;let rT=function e(t){if("string"==typeof t)return t;if(nt(t))return r$(t,e)+"";if(rx(t))return rO?rO.call(t):"";var n=t+"";return"0"==n&&1/t==-rA?"-0":n},rP=function(e,t){return nt(e)?e:rj(e,t)?[e]:rM(null==e?"":rT(e))};var rR=1/0;let rL=function(e){if("string"==typeof e||rx(e))return e;var t=e+"";return"0"==t&&1/e==-rR?"-0":t},rN=function(e,t){t=rP(t,e);for(var n=0,r=t.length;null!=e&&n<r;)e=e[rL(t[n++])];return n&&n==r?e:void 0},rD=function(e,t,n){var r=null==e?void 0:rN(e,t);return void 0===r?n:r},rz=function(e,t){return null!=e&&t in Object(e)},rU=function(e,t,n){t=rP(t,e);for(var r=-1,i=t.length,o=!1;++r<i;){var a=rL(t[r]);if(!(o=null!=e&&n(e,a)))break;e=e[a]}return o||++r!=i?o:!!(i=null==e?0:e.length)&&nu(i)&&ns(a,i)&&(nt(e)||ne(e))},rV=function(e){return e},rF=function(e){var t;return rj(e)?(t=rL(e),function(e){return null==e?void 0:e[t]}):function(t){return rN(t,e)}},rY=function(e){if("function"==typeof e)return e;if(null==e)return rV;if("object"==typeof e){var t,n;return nt(e)?(t=e[0],n=e[1],rj(t)&&rv(n)?rb(rL(t),n):function(e){var r=rD(e,t);return void 0===r&&r===n?null!=e&&rU(e,t,rz):ry(n,r,3)}):rw(e)}return rF(e)};var rW=Object.prototype.hasOwnProperty,rq=(o=function(e,t,n){rW.call(e,n)?e[n].push(t):t1(e,n,[t])},function(e,t){return(nt(e)?t2:nI)(e,o,rY(t,2),{})}),rB=n(58496),rG=n(77241),rH=n(42764),rX=n(34098),rJ=n(78242),rK=n(41423),rZ=n(13862),rQ=n(78719),r0=n(92686),r1=n(40042);function r2(e){if("patch"===e.type)return e.id;if("create"===e.type)return e.document._id;if("delete"===e.type)return e.id;if("createIfNotExists"===e.type||"createOrReplace"===e.type)return e.document._id;throw Error("Invalid mutation type")}let r3=(e=21)=>{let t="",n=crypto.getRandomValues(new Uint8Array(e));for(;e--;)t+="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict"[63&n[e]];return t};function r4(e){return"string"==typeof e?._key}function r5(e){return"object"==typeof e&&"_key"in e&&"string"==typeof e._key}function r6(e){return"number"==typeof e||r5(e)}function r9(e,t){if(0===e.length)return t;let n=t;for(let t of e){if(r6(t)){if(!Array.isArray(n))return;if(r5(t)){n=n.find(e=>e._key===t._key);continue}n=n[t];continue}n=n[t]}return n}let r8=/^[a-z_$]+/;function r7(e){return e.map((e,t)=>{var n;return n=0===t,Array.isArray(e)?`[${e[0]}:${e[1]||""}]`:"number"==typeof e?`[${e}]`:r5(e)?`[_key==${JSON.stringify(e._key)}]`:"string"==typeof e&&r8.test(e)?n?e:`.${e}`:`['${e}']`}).join("")}function ie(e){return null!==e&&"object"==typeof e&&!Array.isArray(e)}function it(e,t){if("number"==typeof t){var n=e.length,r=t;if(0===n&&(-1===r||0===r))return 0;let i=r<0?n+r:r;return i>=n||i<0?null:i}if(r5(t)){let n=e.findIndex(e=>(null!==e&&"object"==typeof e&&"string"==typeof e._key&&e._key||null)===t._key);return -1===n?null:n}throw Error(`Expected path segment to be addressing a single array item either by numeric index or by '_key'. Instead saw ${JSON.stringify(t)}`)}function ir(e,t,n,r){let i=e.slice();return i.splice(t,n,...r||[]),i}function ii(e,t){var n;if(!Array.isArray(t))throw TypeError('Cannot apply "insert()" on non-array value');let r=it(t,e.referenceItem);if(null===r)throw Error(`Found no matching array element to insert ${e.position}`);return 0===t.length?e.items:ir(t,(n=e.position,"before"===n?r:r+1),0,e.items)}let io=Object.prototype.hasOwnProperty.call.bind(Object.prototype.hasOwnProperty);var ia=Object.freeze({__proto__:null,assign:function(e,t){if(!ie(t))throw TypeError('Cannot apply "assign()" on non-object value');return!function(e){for(let t in e)if(io(e,t))return!1;return!0}(e.value)?{...t,...e.value}:t},dec:function(e,t){if("number"!=typeof t)throw TypeError('Cannot apply "dec()" on non-numeric value');return t-e.amount},diffMatchPatch:function(e,t){if("string"!=typeof t)throw TypeError('Cannot apply "diffMatchPatch()" on non-string value');return(0,tM.$i)((0,tM.iz)(e.value),t)[0]},inc:function(e,t){if("number"!=typeof t)throw TypeError('Cannot apply "inc()" on non-numeric value');return t+e.amount},insert:ii,remove:function(e,t){if(!Array.isArray(t))throw TypeError('Cannot apply "remove()" on non-array value');let n=it(t,e.referenceItem);if(null===n)throw Error("Found no matching array element to replace");return ir(t,n,1,[])},replace:function(e,t){if(!Array.isArray(t))throw TypeError('Cannot apply "replace()" on non-array value');let n=it(t,e.referenceItem);if(null===n)throw Error("Found no matching array element to replace");return ir(t,n,e.items.length,e.items)},set:function(e,t){return e.value},setIfMissing:function(e,t){return t??e.value},truncate:function(e,t){if(!Array.isArray(t))throw TypeError('Cannot apply "truncate()" on non-array value');return"number"==typeof e.endIndex?t.slice(0,e.startIndex).concat(t.slice(e.endIndex)):t.slice(0,e.startIndex)},unassign:function(e,t){if(!ie(t))throw TypeError('Cannot apply "unassign()" on non-object value');return 0===e.keys.length?t:function(e,t){let n={...e};for(let e of t)delete n[e];return n}(t,e.keys)},unset:function(e){},upsert:function(e,t){if(!Array.isArray(t))throw TypeError('Cannot apply "upsert()" on non-array value');if(0===e.items.length)return t;let n=[],r=[];if(e.items.forEach((e,i)=>{let o=t.findIndex(t=>t?._key===e._key);o>=0?n[o]=i:r.push(e)}),0===n.length&&0==r.length)return t;let i=[...t];for(let t of n)i[t]=e.items[n[t]];return ii({type:"insert",items:r,referenceItem:e.referenceItem,position:e.position},i)}});function is(e,t){return e.reduce((e,t)=>iu(t,e),t)}function iu(e,t){return function e(t,n,r){if(!(t.length>0)){if(!(n.type in ia))throw Error(`Invalid operation type: "${n.type}"`);return ia[n.type](n,r)}let[i,...o]=t;if(r6(i)&&Array.isArray(r)){var a=i,s=o,u=n,l=r;let t=it(l,a);if(null===t||-1===t)return l;let c=l[t],d=e(s,u,c);return d===c?l:ir(l,t,1,[d])}if("string"==typeof i&&ie(r)){var c=i,d=o,p=n,f=r;let t=f[c];if(void 0===t&&d.length>0)return f;let a=e(d,p,t);return a===t?f:{...f,[c]:a}}throw Error(`Cannot apply operation of type "${n.type}" to path ${r7(t)} on ${typeof r} value`)}(e.path,e.op,t)}function il(e){return"_id"in e}function ic(e,t){return t.reduce((e,t)=>{let n=id(e,t);if("error"===n.status)throw Error(n.message);return"noop"===n.status?e:n.after},e)}function id(e,t){if("create"===t.type)return function(e,t){var n;if(e)return{status:"error",message:"Document already exist"};let r=(n=t.document,il(n)?n:{...n,_id:r3()});return{status:"created",id:r._id,after:r}}(e,t);if("createIfNotExists"===t.type){return n=e,il((r=t).document)?n?{status:"noop"}:{status:"created",id:r.document._id,after:r.document}:{status:"error",message:"Cannot createIfNotExists on document without _id"}}if("delete"===t.type){return i=e,o=t,i?o.id!==i._id?{status:"error",message:"Delete mutation targeted wrong document"}:{status:"deleted",id:o.id,before:i,after:void 0}:{status:"noop"}}if("createOrReplace"===t.type){return a=e,il((s=t).document)?a?{status:"updated",id:s.document._id,before:a,after:s.document}:{status:"created",id:s.document._id,after:s.document}:{status:"error",message:"Cannot createIfNotExists on document without _id"}}if("patch"===t.type){var n,r,i,o,a,s,u=e,l=t;if(!u)return{status:"error",message:"Cannot apply patch on nonexistent document"};let c=function(e,t){if(e.options?.ifRevision&&t._rev!==e.options.ifRevision)throw Error("Revision mismatch");if(e.id!==t._id)throw Error(`Document id mismatch. Refusing to apply mutation for document with id="${e.id}" on the given document with id="${t._id}"`);return is(e.patches,t)}(l,u);return u===c?{status:"noop"}:{status:"updated",id:l.id,before:u,after:c}}throw Error(`Invalid mutation type: ${t.type}`)}function ip(e,t,n){let r=[];for(let n of e.slice().reverse()){if(t(n))return r;r.push(n)}return r.reverse()}function im(e,t){return r7(e)===r7(t)}function iy(e,t){let n=e;return t.reduce((e,t)=>{let r=n;if(n=iu(t,n),"set"===t.op.type&&"string"==typeof t.op.value){let n=r9(t.path,r);if("string"==typeof n){let r={...t,op:{type:"diffMatchPatch",value:(0,tM.w1)((0,tM.jW)(n,t.op.value))}};return e.flatMap(e=>im(e.path,t.path)&&"diffMatchPatch"===e.op.type?[]:e).concat(r)}}return e.push(t),e},[])}function ih(e,t,n,r){let i=t,o=r.map(t=>{let n=t.mutations.flatMap(t=>{if(r2(t)!==e)return[];let n=i;return i=ic(i,[t]),n&&"patch"===t.type?{type:"dmpified",mutation:{...t,dmpPatches:iy(n,t.patches),original:t.patches}}:t});return{...t,mutations:n}}),a=n;return o.map(t=>{let n=[];return t.mutations.forEach(t=>{if("dmpified"===t.type)try{a=is(t.mutation.dmpPatches,a),n.push(t)}catch{console.warn("Failed to apply dmp patch, falling back to original");try{a=is(t.mutation.original,a),n.push(t)}catch(t){throw Error(`Failed to apply patch for document "${e}": ${t.message}`)}}else a=ic(a,[t])})}),[r.map(t=>({...t,mutations:t.mutations.map(t=>"patch"!==t.type||r2(t)!==e?t:{...t,patches:t.patches.map(e=>"set"!==e.op.type?e:{...e,op:{...e.op,value:r9(e.path,a)}})})})),a]}function iv(e){var t=e;if("create"===t.type||"createIfNotExists"===t.type||"createOrReplace"===t.type)return{[t.type]:t.document};if("delete"===t.type)return{delete:{id:t.id}};let n=t.options?.ifRevision;return t.patches.map(e=>({patch:{id:t.id,...n&&{ifRevisionID:n},...function(e){let{path:t,op:n}=e;if("unset"===n.type)return{unset:[r7(t)]};if("insert"===n.type)return{insert:{[n.position]:r7([...t,n.referenceItem]),items:n.items}};if("diffMatchPatch"===n.type)return{diffMatchPatch:{[r7(t)]:n.value}};if("inc"===n.type)return{inc:{[r7(t)]:n.amount}};if("dec"===n.type)return{dec:{[r7(t)]:n.amount}};if("set"===n.type||"setIfMissing"===n.type)return{[n.type]:{[r7(t)]:n.value}};if("truncate"===n.type){let e=[n.startIndex,"number"==typeof n.endIndex?n.endIndex:""].join(":");return{unset:[`${r7(t)}[${e}]`]}}if("upsert"===n.type)return{unset:n.items.map(e=>r7([...t,{_key:e._key}])),insert:{[n.position]:r7([...t,n.referenceItem]),items:n.items}};if("assign"===n.type)return{set:Object.fromEntries(Object.keys(n.value).map(e=>[r7(t.concat(e)),n.value[e]]))};if("unassign"===n.type)return{unset:n.keys.map(e=>r7(t.concat(e)))};if("replace"===n.type)return{insert:{replace:r7(t.concat(n.referenceItem)),items:n.items}};if("remove"===n.type)return{unset:[r7(t.concat(n.referenceItem))]};throw Error(`Unknown operation type ${n.type}`)}(e)}}))}function ig(e){let t=e.listen('*[!(_id in path("_.**"))]',{},{events:["welcome","mutation","reconnect"],includeResult:!1,includePreviousRevision:!1,visibility:"transaction",effectFormat:"mendoza",includeMutations:!1}).pipe((0,rG.u)({resetOnRefCountZero:!0})),n=t.pipe((0,rH.p)(e=>"reconnect"===e.type)),r=t.pipe((0,rH.p)(e=>"welcome"===e.type)),i=t.pipe((0,rH.p)(e=>"mutation"===e.type)),o=(0,tS.h)(r,n).pipe((0,rX.t)({bufferSize:1,refCount:!0})).pipe((0,rH.p)(e=>"welcome"===e.type));return(0,tS.h)(o,i,n)}let ib=(0,rQ.mj)({types:{},actions:{"assign error to context":(0,r0.a)({error:({event:e})=>e}),"clear error from context":(0,r0.a)({error:void 0}),"connect to server-sent events":(0,tj.r)({type:"connect"}),"listen to server-sent events":(0,tj.h)("server-sent events",{id:"listener",input:({context:e})=>({listener:e.sharedListener||ig(e.client),id:e.id})}),"stop listening to server-sent events":(0,tj.k)("listener"),"buffer remote mutation events":(0,r0.a)({mutationEvents:({event:e,context:t})=>((0,rQ.DT)(e,"mutation"),[...t.mutationEvents,e])}),"restore stashed changes":(0,r0.a)({stagedChanges:({event:e,context:t})=>((0,rQ.DT)(e,"xstate.done.actor.submitTransactions"),t.stashedChanges),stashedChanges:[]}),"rebase fetched remote snapshot":(0,r1.a)(({enqueue:e})=>{e.assign(({event:e,context:t})=>{(0,rQ.DT)(e,"xstate.done.actor.getDocument");let n=t.remote,r=e.output,i=!1;for(let e of t.mutationEvents)e.effects?.apply&&(e.previousRev||"appear"===e.transition)&&(i||e.previousRev!==r?._rev||(i=!0),i&&(r=iw(r,e.effects.apply,e.resultRev)));t.cache&&(!t.cache.has(t.id)||t.cache.get(t.id)._rev!==r?._rev)&&t.cache.set(t.id,r);let[o,a]=ih(t.id,null===n?void 0:n,null===r?void 0:r,t.stagedChanges);return{remote:r,local:a,stagedChanges:o,mutationEvents:[]}}),e.sendParent(({context:e})=>({type:"rebased.remote",id:e.id,document:e.remote}))}),"apply mendoza patch":(0,r0.a)(({event:e,context:t})=>{(0,rQ.DT)(e,"mutation");let n=t.remote;if(e.transactionId===n?._rev)return{};let r=iw(n,e.effects.apply,e.resultRev);t.cache&&(!t.cache.has(t.id)||t.cache.get(t.id)._rev!==r?._rev)&&t.cache.set(t.id,r);let[i,o]=ih(t.id,null===n?void 0:n,null===r?void 0:r,t.stagedChanges);return{remote:r,local:o,stagedChanges:i}}),"increment fetch attempts":(0,r0.a)({fetchRemoteSnapshotAttempts:({context:e})=>e.fetchRemoteSnapshotAttempts+1}),"reset fetch attempts":(0,r0.a)({fetchRemoteSnapshotAttempts:0}),"increment submit attempts":(0,r0.a)({submitTransactionsAttempts:({context:e})=>e.submitTransactionsAttempts+1}),"reset submit attempts":(0,r0.a)({submitTransactionsAttempts:0}),"stage mutation":(0,r0.a)({stagedChanges:({event:e,context:t})=>((0,rQ.DT)(e,"mutate"),[...t.stagedChanges,{transaction:!1,mutations:e.mutations}])}),"stash mutation":(0,r0.a)({stashedChanges:({event:e,context:t})=>((0,rQ.DT)(e,"mutate"),[...t.stashedChanges,{transaction:!1,mutations:e.mutations}])}),"rebase local snapshot":(0,r1.a)(({enqueue:e})=>{e.assign({local:({event:e,context:t})=>{(0,rQ.DT)(e,"mutate");let n=new Map;return t.local&&n.set(t.id,t.local),function(e,t){e.forEach(e=>{("created"===e.status||"updated"===e.status)&&t.set(e.id,e.after),"deleted"===e.status&&t.delete(e.id)})}(function(e,t){let n=Object.create(null);for(let r of e){let e=r2(r);if(!e)throw Error("Unable to get document id from mutation");let i=n[e]?.after||t.get(e),o=id(i,r);if("error"===o.status)throw Error(o.message);"noop"!==o.status&&("updated"===o.status||"created"===o.status||"deleted"===o.status)&&(e in n||(n[e]={before:i,after:void 0,muts:[]}),n[e].after=o.after)}return Object.entries(n).map(([e,{before:t,after:n,muts:r}])=>({id:e,status:n?t?"updated":"created":"deleted",mutations:r,before:t,after:n}))}(e.mutations,n),n),n.get(t.id)}}),e.sendParent(({context:e})=>({type:"rebased.local",id:e.id,document:e.local}))}),"send pristine event to parent":(0,r1.s)(({context:e})=>({type:"pristine",id:e.id})),"send sync event to parent":(0,r1.s)(({context:e})=>({type:"sync",id:e.id,document:e.remote})),"send mutation event to parent":(0,r1.s)(({context:e,event:t})=>((0,rQ.DT)(t,"mutation"),{type:"mutation",id:e.id,previousRev:t.previousRev,resultRev:t.resultRev,effects:t.effects}))},actors:{"server-sent events":(0,q.OX)(({input:e})=>{let{listener:t,id:n}=e;return(0,rJ.v)(()=>t).pipe((0,rH.p)(e=>"welcome"===e.type||"reconnect"===e.type||"mutation"===e.type&&e.documentId===n),(0,rK.Q)(rZ.$))}),"fetch remote snapshot":(0,q.Sx)(async({input:e,signal:t})=>{let{client:n,id:r}=e;return await n.getDocument(r,{signal:t}).catch(e=>{if(!(e instanceof Error&&"AbortError"===e.name))throw e})}),"submit mutations as transactions":(0,q.Sx)(async({input:e,signal:t})=>{let{client:n,transactions:r}=e;for(let e of r){if(t.aborted)return;await n.dataRequest("mutate",function(e){return{transactionId:e.id,mutations:e.mutations.flatMap(iv)}}(e),{visibility:"async",returnDocuments:!1,signal:t}).catch(e=>{if(!(e instanceof Error&&"AbortError"===e.name))throw e})}})},delays:{fetchRemoteSnapshotTimeout:({context:e})=>1e3*Math.pow(2,e.fetchRemoteSnapshotAttempts),submitTransactionsTimeout:({context:e})=>1e3*Math.pow(2,e.submitTransactionsAttempts)}}).createMachine({id:"document-mutator",context:({input:e})=>({client:e.client.withConfig({allowReconfigure:!1}),sharedListener:e.sharedListener,id:e.id,remote:void 0,local:void 0,mutationEvents:[],stagedChanges:[],stashedChanges:[],error:void 0,fetchRemoteSnapshotAttempts:0,submitTransactionsAttempts:0,cache:e.cache}),entry:["connect to server-sent events"],on:{mutate:{actions:["rebase local snapshot","stage mutation"]}},initial:"disconnected",states:{disconnected:{on:{connect:{target:"connecting",actions:["listen to server-sent events"]}}},connecting:{on:{welcome:"connected",reconnect:"reconnecting",error:"connectFailure"},tags:["busy"]},connectFailure:{on:{connect:{target:"connecting",actions:["listen to server-sent events"]}},entry:["stop listening to server-sent events","assign error to context"],exit:["clear error from context"],tags:["error"]},reconnecting:{on:{welcome:{target:"connected"},error:{target:"connectFailure"}},tags:["busy","error"]},connected:{on:{mutation:{actions:["buffer remote mutation events"]},reconnect:"reconnecting"},entry:["clear error from context"],initial:"loading",states:{loading:{invoke:{src:"fetch remote snapshot",id:"getDocument",input:({context:e})=>({client:e.client,id:e.id}),onError:{target:"loadFailure"},onDone:{target:"loaded",actions:["rebase fetched remote snapshot","reset fetch attempts"]}},tags:["busy"]},loaded:{entry:["send sync event to parent"],on:{mutation:{actions:["apply mendoza patch","send mutation event to parent"]}},initial:"pristine",states:{pristine:{on:{mutate:{actions:["rebase local snapshot","stage mutation"],target:"dirty"}},tags:["ready"]},dirty:{on:{submit:"submitting"},tags:["ready"]},submitting:{on:{mutate:{actions:["rebase local snapshot","stash mutation"]}},invoke:{src:"submit mutations as transactions",id:"submitTransactions",input:({context:e})=>{let t=new Map;return t.set(e.id,e.remote),{client:e.client,transactions:(function(e,t){let n=[],r=[];return e.forEach(e=>{t(e)?r.push(e):(r.length>0&&n.push(r),r=[],n.push([e]))}),r.length>0&&n.push(r),n})(e.stagedChanges,e=>!e.transaction).flatMap(e=>({...e[0],mutations:e.flatMap(e=>e.mutations)})).map(e=>({...e,mutations:Object.values(rq(e.mutations,r2)).flatMap(e=>{var t,n;return(0===(n=0===(t=e).length?t:t.reduce((e,t)=>"delete"===t.type?[t]:(e.push(t),e),[])).length?n:n.reduce((e,t)=>("createIfNotExists"!==t.type?e.push(t):ip(e,e=>"delete"===e.type).find(e=>"createIfNotExists"===e.type)||e.push(t),e),[])).flat().reduce((e,t)=>{let n=e[e.length-1];return n&&"patch"!==n.type||"patch"!==t.type?e.concat(t):e.slice(0,-1).concat({...t,patches:(n?.patches||[]).concat(t.patches)})},[])})})).map(e=>({...e,mutations:e.mutations.map(e=>"patch"!==e.type?e:{...e,patches:e.patches.reduce((e,t)=>{if("unset"!==t.op.type)return e.push(t),e;let n=e.filter(e=>{var n,r;return n=t.path,r=e.path,!(n.length<=r.length&&n.every((e,t)=>{var n,i;return n=e,i=function(e,t){if(t<0||t>=e.length)throw Error("Index out of bounds");return e[t]}(r,t),r4(n)&&r4(i)?n._key===i._key:"number"==typeof n?Number(n)===Number(i):n===i}))});return n.push(t),n},[]).reduceRight((e,t)=>(e.find(e=>{var n,r;return n=e.op,("set"===(r=t.op).type||"unset"===r.type)&&("set"===n.type||"unset"===n.type)&&im(e.path,t.path)})||e.unshift(t),e),[]).reduce((e,t)=>("setIfMissing"!==t.op.type?e.push(t):ip(e,e=>"unset"===e.op.type).find(e=>"setIfMissing"===e.op.type&&im(e.path,t.path))||e.push(t),e),[])})})).map(e=>{var n;return{...e,mutations:(n=t,e.mutations.map((e,t)=>{var r,i;return"patch"===e.type?(r=n.get(e.id),i=e,r?{...i,patches:iy(r,i.patches)}:i):e}))}}).map(e=>e.transaction&&void 0!==e.id?{id:e.id,mutations:e.mutations}:{mutations:e.mutations})}},onError:{target:"submitFailure"},onDone:{target:"pristine",actions:["restore stashed changes","reset submit attempts","send pristine event to parent"]}},tags:["busy","ready"]},submitFailure:{exit:["clear error from context"],after:{submitTransactionsTimeout:{actions:["increment submit attempts"],target:"submitting"}},on:{retry:"submitting"},tags:["error","ready"]}}},loadFailure:{exit:["clear error from context"],after:{fetchRemoteSnapshotTimeout:{actions:["increment fetch attempts"],target:"loading"}},on:{retry:"loading"},tags:["error"]}}}}});function iw(e,t,n){let r=(0,rB.X)(function(e){if(!e)return null;let{_rev:t,...n}=e;return n}(e),t);return r?Object.assign(r,{_rev:n}):null}let ix=(0,rQ.mj)({types:{},actions:{"emit sync event":(0,r1.e)(({event:e})=>((0,rQ.DT)(e,"sync"),e)),"emit mutation event":(0,r1.e)(({event:e})=>((0,rQ.DT)(e,"mutation"),e)),"emit rebased event":(0,r1.e)(({event:e})=>((0,rQ.DT)(e,["rebased.local","rebased.remote"]),e)),"emit pristine event":(0,r1.e)(({event:e})=>((0,rQ.DT)(e,["pristine"]),e)),"add document actor":(0,r0.a)({documents:({context:e,event:t,spawn:n})=>{(0,rQ.DT)(t,"observe");let r=t.documentId;return e.documents[r]?e.documents:{...e.documents,[r]:n("documentMutatorMachine",{input:{id:r,client:e.client,sharedListener:e.sharedListener||ig(e.client)},id:r})}}}),"stop remote snapshot":(0,tj.k)(({context:e,event:t})=>((0,rQ.DT)(t,"unobserve"),e.documents[t.documentId])),"remove remote snapshot from context":(0,r0.a)({documents:({context:e,event:t})=>{if((0,rQ.DT)(t,"unobserve"),!e.documents[t.documentId])return e.documents;let{[t.documentId]:n,...r}=e.documents;return r}})},actors:{documentMutatorMachine:ib}}).createMachine({id:"dataset-mutator",context:({input:e})=>({documents:{},client:e.client,sharedListener:e.sharedListener}),on:{sync:{actions:["emit sync event"]},mutation:{actions:["emit mutation event"]},"rebased.*":{actions:["emit rebased event"]},pristine:{actions:["emit pristine event"]},observe:{actions:["add document actor"]},unobserve:{actions:["stop remote snapshot","remove remote snapshot from context"]}},initial:"pristine",states:{pristine:{}}}),iE=e=>{let t,n,r,i,o=(0,l.c)(8),{comlink:a,history:s}=e;return o[0]!==a||o[1]!==s?(t=()=>a?.on("presentation/navigate",e=>{s?.update(e)}),n=[a,s],o[0]=a,o[1]=s,o[2]=t,o[3]=n):(t=o[2],n=o[3]),(0,d.useEffect)(t,n),o[4]!==a||o[5]!==s?(r=()=>{if(s)return s.subscribe(e=>{e.title=e.title||document.title,a?.post("visual-editing/navigate",e)})},i=[a,s],o[4]=a,o[5]=s,o[6]=r,o[7]=i):(r=o[6],i=o[7]),(0,d.useEffect)(r,i),null},i_=e=>{let t,n,r=(0,l.c)(3),{comlink:i}=e;return r[0]!==i?(t=()=>{let e=()=>{i.post("visual-editing/meta",{title:document.title})},t=new MutationObserver(t=>{let[n]=t;"TITLE"===n.target.nodeName&&e()});return t.observe(document.head,{subtree:!0,characterData:!0,childList:!0}),e(),()=>t.disconnect()},n=[i],r[0]=i,r[1]=t,r[2]=n):(t=r[1],n=r[2]),(0,d.useEffect)(t,n),null};function ij(e){let t=new CustomEvent("sanity/dragEnd",{detail:e,cancelable:!0});window.dispatchEvent(t)}let ik=(0,d.createContext)(null);function iI(){let e=(0,d.useContext)(ik);if(!e)throw Error("Schema context is missing");return e}function iS(e,t,n,r){if(!e.type)throw Error("Node type is missing");return()=>t.patch(()=>(function(e,t,n){let{path:r,key:i}=ef(e);return[W(r,V([{_type:t,_key:ep()}],n,{_key:i}))]})(e,n,r))}function iM(e){let{node:t,doc:n}=e;return n?[{type:"action",label:"Duplicate",icon:ti.TdU,action:function(e,t){if(!e.type)throw Error("Node type is missing");return()=>t.patch(async({getSnapshot:t})=>(function(e,t,n="after"){let{path:r,key:i}=ef(e);return[W(r,V({...en(t,e.path),_key:ep()},n,{_key:i}))]})(e,await t()))}(t,n),telemetryEvent:"Visual Editing Context Menu Item Duplicated"}]:[]}function i$(e){let{node:t,doc:n}=e;return n?[{type:"action",label:"Remove",icon:ti.YPx,action:function(e,t){if(!e.type)throw Error("Node type is missing");return()=>t.patch(async({getSnapshot:t})=>(function(e,t){let{path:n,key:r}=ef(e),i=en(t,n).findIndex(e=>e._key===r);return[W(n,F(i,i+1))]})(e,await t()))}(t,n),telemetryEvent:"Visual Editing Context Menu Item Removed"}]:[]}async function iA(e,t=!0){let{node:n,doc:r}=e;if(!r)return[];let i=[],o=[],[a,s,u,l]=await Promise.all([em(n,r,"previous"),em(n,r,"next"),em(n,r,"first"),em(n,r,"last")]);return u.length&&o.push({type:"action",label:"To top",icon:ti.VQ$,action:()=>r.patch(u),telemetryEvent:"Visual Editing Context Menu Item Moved"}),a.length&&o.push({type:"action",label:"Up",icon:ti.Kpk,action:()=>r.patch(a),telemetryEvent:"Visual Editing Context Menu Item Moved"}),s.length&&o.push({type:"action",label:"Down",icon:ti.ZLN,action:()=>r.patch(s),telemetryEvent:"Visual Editing Context Menu Item Moved"}),l.length&&o.push({type:"action",label:"To bottom",icon:ti.wvk,action:()=>r.patch(l),telemetryEvent:"Visual Editing Context Menu Item Moved"}),o.length&&(i.push({type:"group",label:"Move",icon:ti.ycB,items:o}),t&&i.push({type:"divider"})),i}async function iC(e){let{node:t,field:n,doc:r}=e,i=[];return i.push(...iM(e)),i.push(...i$(e)),i.push(...await iA(e)),i.push({type:"action",label:"Insert before",icon:ti.SKY,action:iS(t,r,n.name,"before"),telemetryEvent:"Visual Editing Context Menu Item Inserted"}),i.push({type:"action",label:"Insert after",icon:ti.amD,action:iS(t,r,n.name,"after"),telemetryEvent:"Visual Editing Context Menu Item Inserted"}),i}let iO=e=>{let t,n,r,i,o,a=(0,l.c)(12),{label:s,parent:c,width:d,onSelect:p,boundaryElement:f}=e;return a[0]===Symbol.for("react.memo_cache_sentinel")?(t=["left-start","right","left","right-end","left-end","bottom","top"],a[0]=t):t=a[0],a[1]===Symbol.for("react.memo_cache_sentinel")?(n=[4,4,4,4],a[1]=n):n=a[1],a[2]!==f||a[3]!==d?(r={arrow:!1,constrainSize:!0,floatingBoundary:f,padding:0,placement:"right-start",fallbackPlacements:t,preventOverflow:!0,width:d,__unstable_margins:n},a[2]=f,a[3]=d,a[4]=r):r=a[4],a[5]!==p||a[6]!==c?(i=(0,u.jsx)(tv,{node:c,onSelect:p}),a[5]=p,a[6]=c,a[7]=i):i=a[7],a[8]!==s||a[9]!==r||a[10]!==i?(o=(0,u.jsx)(M.rX,{fontSize:1,icon:ti.amD,padding:2,popover:r,space:2,text:s,children:i}),a[8]=s,a[9]=r,a[10]=i,a[11]=o):o=a[11],o};async function iT(e){let{doc:t,node:n,parent:r}=e,i=[];if(i.push(...iM(e)),i.push(...i$(e)),i.push(...await iA(e)),r.options?.insertMenu){let e=(r.options.insertMenu||{}).views?.some(e=>"grid"===e.name)?0:void 0;i.push({type:"custom",component:({boundaryElement:i,sendTelemetry:o})=>(0,u.jsx)(iO,{label:"Insert before",onSelect:e=>{iS(n,t,e.name,"before")(),o("Visual Editing Context Menu Item Inserted",null)},parent:r,width:e,boundaryElement:i})}),i.push({type:"custom",component:({boundaryElement:i,sendTelemetry:o})=>(0,u.jsx)(iO,{label:"Insert after",onSelect:e=>{iS(n,t,e.name,"after")(),o("Visual Editing Context Menu Item Inserted",null)},parent:r,width:e,boundaryElement:i})})}else i.push({type:"group",label:"Insert before",icon:ti.SKY,items:r.of.filter(e=>"unionOption"===e.type).map(e=>({type:"action",icon:to(e),label:"block"===e.name?"Paragraph":e.title||e.name,action:iS(n,t,e.name,"before"),telemetryEvent:"Visual Editing Context Menu Item Inserted"}))}),i.push({type:"group",label:"Insert after",icon:ti.amD,items:r.of.filter(e=>"unionOption"===e.type).map(e=>({type:"action",label:"block"===e.name?"Paragraph":e.title||e.name,icon:to(e),action:iS(n,t,e.name,"after"),telemetryEvent:"Visual Editing Context Menu Item Inserted"}))});return i}let iP=[-4,4,-4,4];function iR(e){let t,n=(0,l.c)(27),{node:r,onDismiss:i,boundaryElement:o}=e,a=ty();n[0]!==r||n[1]!==i||n[2]!==a?(t=()=>{"action"===r.type&&(r.action?.(),i?.(),r.telemetryEvent&&a(r.telemetryEvent,null))},n[0]=r,n[1]=i,n[2]=a,n[3]=t):t=n[3];let s=t;if("divider"===r.type){let e;return n[4]===Symbol.for("react.memo_cache_sentinel")?(e=(0,u.jsx)(M.Nj,{}),n[4]=e):e=n[4],e}if("action"===r.type){let e,t=!r.action;return n[5]!==r.hotkeys||n[6]!==r.icon||n[7]!==r.label||n[8]!==s||n[9]!==t?(e=(0,u.jsx)(M.Dr,{fontSize:1,hotkeys:r.hotkeys,icon:r.icon,padding:2,space:2,text:r.label,disabled:t,onClick:s}),n[5]=r.hotkeys,n[6]=r.icon,n[7]=r.label,n[8]=s,n[9]=t,n[10]=e):e=n[10],e}if("group"===r.type){let e,t,a,s=r.icon;n[11]===Symbol.for("react.memo_cache_sentinel")?(e={arrow:!1,constrainSize:!0,placement:"right-start",fallbackPlacements:["left-start","right","left","right-end","left-end","bottom","top"],preventOverflow:!0,__unstable_margins:iP},n[11]=e):e=n[11];let l=r.label;if(n[12]!==o||n[13]!==r.items||n[14]!==i){let e;n[16]!==o||n[17]!==i?(e=(e,t)=>(0,u.jsx)(iR,{node:e,onDismiss:i,boundaryElement:o},t),n[16]=o,n[17]=i,n[18]=e):e=n[18],t=r.items.map(e),n[12]=o,n[13]=r.items,n[14]=i,n[15]=t}else t=n[15];return n[19]!==r.icon||n[20]!==r.label||n[21]!==t?(a=(0,u.jsx)(M.rX,{fontSize:1,icon:s,padding:2,popover:e,space:2,text:l,children:t}),n[19]=r.icon,n[20]=r.label,n[21]=t,n[22]=a):a=n[22],a}if("custom"===r.type){let e,{component:t}=r;return n[23]!==t||n[24]!==o||n[25]!==a?(e=(0,u.jsx)(t,{boundaryElement:o,sendTelemetry:a}),n[23]=t,n[24]=o,n[25]=a,n[26]=e):e=n[26],e}return null}let iL=e=>{let t,n,r,i,o,a,s,c,p,f,m,y,h,v,g,b=(0,l.c)(43),{node:w,onDismiss:x,position:E}=e,{x:_,y:j}=E,[k,I]=(0,d.useState)(null),{getField:S}=iI(),{getDocument:$}=ec();b[0]!==S||b[1]!==w?(t=S(w),b[0]=S,b[1]=w,b[2]=t):t=b[2];let{field:A,parent:C}=t,O=A?.title||A?.name||"Unknown type",[T,P]=(0,d.useState)(void 0);b[3]!==A||b[4]!==$||b[5]!==w||b[6]!==C?(n=()=>{(async()=>{let e=$(w.id);e&&P(await function(e){let{node:t,field:n,parent:r,doc:i}=e;return n?.type==="arrayItem"?iC({node:t,field:n,doc:i}):r?.type==="union"?iT({node:t,parent:r,doc:i}):Promise.resolve([])}({node:w,field:A,parent:C,doc:e}))})()},r=[A,w,C,$],b[3]=A,b[4]=$,b[5]=w,b[6]=C,b[7]=n,b[8]=r):(n=b[7],r=b[8]),(0,d.useEffect)(n,r),b[9]!==_||b[10]!==j?(i={getBoundingClientRect:()=>({bottom:j,left:_,right:_,top:j,width:0,height:0})},b[9]=_,b[10]=j,b[11]=i):i=b[11];let R=i;b[12]!==A?(o=to(A),b[12]=A,b[13]=o):o=b[13];let L=o;b[14]===Symbol.for("react.memo_cache_sentinel")?(a={minWidth:120,maxWidth:160},b[14]=a):a=b[14],b[15]!==L||b[16]!==T?(s=(0,u.jsx)(M.az,{flex:"none",children:T?(0,u.jsx)(M.EY,{size:1,children:L}):(0,u.jsx)(M.y$,{size:1})}),b[15]=L,b[16]=T,b[17]=s):s=b[17];let N=T?O:"Loading...";b[18]!==N?(c=(0,u.jsx)(M.BJ,{flex:1,space:2,children:(0,u.jsx)(M.EY,{size:1,weight:"semibold",children:N})}),b[18]=N,b[19]=c):c=b[19],b[20]!==s||b[21]!==c?(p=(0,u.jsxs)(M.so,{gap:2,padding:2,children:[s,c]}),b[20]=s,b[21]=c,b[22]=p):p=b[22],b[23]!==k||b[24]!==T||b[25]!==x?(f=T&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(M.Nj,{}),T.map((e,t)=>(0,u.jsx)(iR,{node:e,onDismiss:x,boundaryElement:k},t))]}),b[23]=k,b[24]=T,b[25]=x,b[26]=f):f=b[26],b[27]!==p||b[28]!==f?(m=(0,u.jsxs)(M.W1,{style:a,children:[p,f]}),b[27]=p,b[28]=f,b[29]=m):m=b[29];let D=`${_}-${j}`;return b[30]!==_||b[31]!==j?(y={position:"absolute",left:_,top:j},b[30]=_,b[31]=j,b[32]=y):y=b[32],b[33]!==D||b[34]!==y?(h=(0,u.jsx)("div",{style:y},D),b[33]=D,b[34]=y,b[35]=h):h=b[35],b[36]!==R||b[37]!==m||b[38]!==h?(v=(0,u.jsx)(M.AM,{__unstable_margins:iP,arrow:!1,open:!0,placement:"right-start",referenceElement:R,content:m,children:h}),b[36]=R,b[37]=m,b[38]=h,b[39]=v):v=b[39],b[40]!==x||b[41]!==v?(g=(0,u.jsx)(tl,{setBoundaryElement:I,onDismiss:x,children:v}),b[40]=x,b[41]=v,b[42]=g):g=b[42],g},iN=(0,d.createContext)(null),iD=(0,$.I4)(M.Zp)`
  background-color: var(--overlay-bg);
  border-radius: 3px;
  pointer-events: none;
  position: absolute;
  will-change: transform;
  box-shadow: var(--overlay-box-shadow);
  transition: none;

  --overlay-bg: transparent;
  --overlay-box-shadow: inset 0 0 0 1px transparent;

  [data-overlays] & {
    --overlay-bg: color-mix(in srgb, transparent 95%, var(--card-focus-ring-color));
    --overlay-box-shadow: inset 0 0 0 2px
      color-mix(in srgb, transparent 50%, var(--card-focus-ring-color));
  }

  [data-fading-out] & {
    transition:
      box-shadow 1550ms,
      background-color 1550ms;

    --overlay-bg: rgba(0, 0, 255, 0);
    --overlay-box-shadow: inset 0 0 0 1px transparent;
  }

  &[data-focused] {
    --overlay-box-shadow: inset 0 0 0 1px var(--card-focus-ring-color);
  }

  &[data-hovered]:not([data-focused]) {
    transition: none;
    --overlay-box-shadow: inset 0 0 0 2px var(--card-focus-ring-color);
  }

  /* [data-unmounted] & {
    --overlay-box-shadow: inset 0 0 0 1px var(--card-focus-ring-color);
  } */

  :link {
    text-decoration: none;
  }
`,iz=(0,$.I4)(M.so)`
  bottom: 100%;
  cursor: pointer;
  pointer-events: none;
  position: absolute;
  right: 0;

  [data-hovered]:not([data-menu-open]) & {
    pointer-events: all;
  }

  [data-flipped] & {
    bottom: auto;
    top: 100%;
  }
`,iU=(0,$.I4)(M.so)`
  top: 100%;
  cursor: pointer;
  pointer-events: none;
  position: absolute;
  left: 0;

  gap: 4px;
  padding: 4px 0;
  flex-wrap: wrap;

  [data-hovered]:not([data-menu-open]) & {
    pointer-events: all;
  }

  [data-flipped] & {
    top: calc(100% + 2rem);
  }
`,iV=(0,$.I4)(M.so)`
  margin: -0.5rem;

  [data-hovered]:not([data-menu-open]) & {
    pointer-events: all;
  }
`,iF=(0,$.I4)(M.so)`
  bottom: 100%;
  cursor: pointer;
  pointer-events: none;
  position: absolute;
  left: 0;

  [data-hovered]:not([data-menu-open]) & {
    pointer-events: all;
  }

  [data-flipped] & {
    bottom: auto;
    top: 100%;
  }
`,iY=(0,$.I4)(M.Zp)`
  cursor: pointer;
  background-color: var(--card-focus-ring-color);
  right: 0;
  border-radius: 3px;

  & [data-ui='Text'] {
    color: #fff;
    white-space: nowrap;
  }
`,iW=(0,$.I4)(M.so)`
  display: flex;
  align-items: center;
  background-color: var(--card-focus-ring-color);
  right: 0;
  border-radius: 3px;
  & [data-ui='Text'],
  & [data-sanity-icon] {
    color: #fff;
    white-space: nowrap;
  }
`,iq=$.I4.div`
  position: absolute;
  inset: 0;
  pointer-events: all;
`,iB=e=>{let t,n,r,i,o,a,s,c,p,f,m,y,h,v,g,w,x,_=(0,l.c)(59),{id:I,element:$,focused:A,componentResolver:C,node:O,showActions:T,draggable:P,targets:R,elementType:L,comlink:N,onActivateExclusivePlugin:D,onMenuOpenChange:z}=e,{getField:U,getType:V}=iI();_[0]!==V||_[1]!==O?(t=V(O),_[0]=V,_[1]=O,_[2]=t):t=_[2];let F=t;_[3]!==O?(n="path"in O?function(e){let{id:t,type:n,path:r,baseUrl:i,tool:o,workspace:a}=e;return function(e){let{baseUrl:t,workspace:n="default",tool:r="default",id:i,type:o,path:a,projectId:s,dataset:u}=e;if(!t)throw Error("baseUrl is required");if(!a)throw Error("path is required");if(!i)throw Error("id is required");if("/"!==t&&t.endsWith("/"))throw Error("baseUrl must not end with a slash");let l="default"===n?void 0:n,c="default"===r?void 0:r,d=S(i),p=Array.isArray(a)?b(a.map(e=>{if("string"==typeof e||"number"==typeof e)return e;if(""!==e._key)return{_key:e._key};if(-1!==e._index)return e._index;throw Error(`invalid segment:${JSON.stringify(e)}`)})):a,f=new URLSearchParams({baseUrl:t,id:d,type:o,path:p});if(l&&f.set("workspace",l),c&&f.set("tool",c),s&&f.set("projectId",s),u&&f.set("dataset",u),j(i)||k(i)){if(k(i)){let e=function(e){if(!k(e))return;let[t,n,...r]=e.split(".");return n}(i);f.set("perspective",e)}}else f.set("perspective","published");let m=["/"===t?"":t];l&&m.push(l);let y=["mode=presentation",`id=${d}`,`type=${o}`,`path=${encodeURIComponent(p)}`];return c&&y.push(`tool=${c}`),m.push("intent","edit",`${y.join(";")}?${f}`),m.join("/")}({baseUrl:i,workspace:a,tool:o,type:n,id:t,path:r?function(e){let t="";for(let n of e){if("string"==typeof n){t&&(t+="."),t+=n;continue}if("number"==typeof n){t&&(t+=":"),t+=`${n}`;continue}if(null!==n&&Array.isArray(n)){t&&(t+=":"),t+=`${n.join(",")}}`;continue}if(n._key){t&&(t+=":"),t+=`${n._key}`;continue}}return t}(E.fromString(r)):[]})}(O):O.href,_[3]=O,_[4]=n):n=_[4];let Y=n,W=function(){let e=(0,d.useContext)(iN);if(!e)throw Error("Preview Snapshots context is missing");return e}();e:{let e;if(!("path"in O)){r=void 0;break e}_[5]!==O||_[6]!==W?(e=W.find(e=>e._id===O.id)?.title,_[5]=O,_[6]=W,_[7]=e):e=_[7],r=e}let q=r;_[8]!==$||_[9]!==A||_[10]!==U||_[11]!==V?(i=function(e,t){let n=V(e),{field:r,parent:i}=U(e);if(!("id"in e)||!r||!n)return;let o=r.value.type;return{document:n,element:$,targetElement:t||$,field:r,focused:!!A,node:e,parent:i,type:o}},_[8]=$,_[9]=A,_[10]=U,_[11]=V,_[12]=i):i=_[12];let B=i;if(_[13]!==L||_[14]!==B||_[15]!==O?(o="element"===L?B(O):void 0,_[13]=L,_[14]=B,_[15]=O,_[16]=o):o=_[16],_[17]!==B||_[18]!==R){let e;_[20]!==B?(e=e=>B(e.sanity,e.element),_[20]=B,_[21]=e):e=_[21],a=R.map(e).filter(iJ),_[17]=B,_[18]=R,_[19]=a}else a=_[19];_[22]!==o||_[23]!==a?(s={legacyComponentContext:o,pluginContexts:a},_[22]=o,_[23]=a,_[24]=s):s=_[24];let G=s,H=function(e,t){let n,r=(0,l.c)(4);e:{let i;if(!e){n=void 0;break e}if(r[0]!==e||r[1]!==t){let o=t?.(e);if(!o){n=void 0;break e}if((0,d.isValidElement)(o)){n=o;break e}i=(Array.isArray(o)?o:[o]).map(iH),r[0]=e,r[1]=t,r[2]=i,r[3]=n}else i=r[2],n=r[3];n=i}return n}(G.legacyComponentContext,C),X=function(e,t){let n,r=(0,l.c)(5);if(r[0]!==e||r[1]!==t){let i;r[3]!==t?(i=e=>{let n={id:eL(),context:e,hud:[],exclusive:[]};return t?.forEach(t=>{t.guard?.(e)&&("hud"===t.type&&n.hud.push(t),"exclusive"===t.type&&n.exclusive.push(t))}),n},r[3]=t,r[4]=i):i=r[4],n=e.map(i),r[0]=e,r[1]=t,r[2]=n}else n=r[2];return n}(G.pluginContexts,e.plugins);_[25]!==F?(c=F?.icon?(0,u.jsx)("div",{dangerouslySetInnerHTML:{__html:F.icon}}):(0,u.jsx)(ti.pyG,{}),_[25]=F,_[26]=c):c=_[26];let J=c,K=(0,d.useId)();_[27]!==X?(p=X?.some(iK),_[27]=X,_[28]=p):p=_[28];let Z=p||X?.length>1;_[29]!==I?(f=()=>{window.dispatchEvent(new CustomEvent("sanity-overlay/label-click",{detail:{id:I}}))},_[29]=I,_[30]=f):f=_[30];let Q=f;return _[31]!==Y||_[32]!==T?(m=T?(0,u.jsx)(iz,{gap:1,paddingY:1,children:(0,u.jsx)(iX,{href:Y})}):null,_[31]=Y,_[32]=T,_[33]=m):m=_[33],_[34]!==N||_[35]!==P||_[36]!==Q||_[37]!==J||_[38]!==K||_[39]!==X||_[40]!==D||_[41]!==z||_[42]!==Z||_[43]!==q?(y=(q||Z)&&(0,u.jsx)(iF,{gap:1,paddingY:1,onClick:Q,children:(0,u.jsxs)(iW,{gap:2,padding:2,children:[P&&(0,u.jsx)(M.az,{marginRight:1,children:(0,u.jsx)(M.EY,{className:"drag-handle",size:0,children:(0,u.jsx)(ti.GG1,{})})}),(0,u.jsx)(M.EY,{size:0,children:J}),q&&(0,u.jsx)(M.EY,{size:1,weight:"medium",children:q}),Z&&(0,u.jsx)(M.az,{paddingLeft:2,onClick:iZ,children:(0,u.jsx)(iV,{children:(0,u.jsx)(tx.IU,{id:K,popover:{animate:!0,placement:"bottom-start",constrainSize:!0,tone:"default"},onOpen:()=>{z?.(!0)},onClose:()=>{z?.(!1)},button:(0,u.jsx)(M.$n,{icon:ti.Lz$,tone:"primary",padding:2}),menu:(0,u.jsx)(M.W1,{paddingY:0,children:(0,u.jsx)(tw,{children:X?.map((e,t)=>(0,u.jsxs)(d.Fragment,{children:[(0,u.jsxs)(M.BJ,{role:"group",paddingY:1,space:0,children:[(0,u.jsx)(M.Dr,{paddingY:2,text:(0,u.jsx)(M.az,{paddingY:2,children:(0,u.jsx)(M.EY,{muted:!0,size:1,style:{textTransform:"capitalize"},children:`${e.context.document.name}: ${e.context.field?.name}`})}),onClick:()=>{e.context.node&&N?.post("visual-editing/focus",e.context.node)}}),e.exclusive.map(t=>t.component?(0,u.jsx)(M.Dr,{paddingY:2,icon:t.icon||(0,u.jsx)(ti.gP2,{}),text:(0,u.jsx)(M.az,{paddingY:2,children:(0,u.jsx)(M.EY,{size:1,children:t.title||t.name})}),onClick:()=>D?.(t,e.context)},t.name):null)]}),t<X.length-1&&(0,u.jsx)(M.Nj,{})]},e.id))})})})})})]})}),_[34]=N,_[35]=P,_[36]=Q,_[37]=J,_[38]=K,_[39]=X,_[40]=D,_[41]=z,_[42]=Z,_[43]=q,_[44]=y):y=_[44],_[45]!==X?(h=X?.map(iQ),_[45]=X,_[46]=h):h=_[46],_[47]!==h?(v=(0,u.jsx)(iU,{children:h}),_[47]=h,_[48]=v):v=_[48],_[49]!==m||_[50]!==y||_[51]!==v?(g=(0,u.jsxs)(tw,{children:[m,y,v]}),_[49]=m,_[50]=y,_[51]=v,_[52]=g):g=_[52],_[53]!==H||_[54]!==G.legacyComponentContext?(w=Array.isArray(H)?H.map((e,t)=>{let{component:n,props:r}=e;return(0,u.jsx)(n,{PointerEvents:tw,...G.legacyComponentContext,...r},t)}):H,_[53]=H,_[54]=G.legacyComponentContext,_[55]=w):w=_[55],_[56]!==g||_[57]!==w?(x=(0,u.jsxs)(u.Fragment,{children:[g,w]}),_[56]=g,_[57]=w,_[58]=x):x=_[58],x},iG=(0,d.memo)(function(e){let t,n,r,i,o,a,s,c,p,f,m,y,h,v=(0,l.c)(38),{draggable:g,focused:b,hovered:w,rect:x,wasMaybeCollapsed:E,enableScrollIntoView:_}=e,j=(0,d.useRef)(null),k=(0,d.useRef)(!1),I=`${x.w}px`,S=`${x.h}px`,M=`translate(${x.x}px, ${x.y}px)`;v[0]!==I||v[1]!==S||v[2]!==M?(t={width:I,height:S,transform:M},v[0]=I,v[1]=S,v[2]=M,v[3]=t):t=v[3];let $=t;v[4]!==_||v[5]!==b||v[6]!==E?(n=()=>{if(!k.current&&!E&&!0===b&&j.current&&_){let e=j.current;(0,tE.A)(j.current,{behavior:t=>{0!==t.length&&e.scrollIntoView({behavior:"smooth",block:"center",inline:"nearest"})},scrollMode:"if-needed",block:"center",inline:"nearest"})}k.current=!0===b},r=[b,E,_],v[4]=_,v[5]=b,v[6]=E,v[7]=n,v[8]=r):(n=v[7],r=v[8]),(0,d.useEffect)(n,r);let[A,C]=(0,d.useState)(!1);v[9]!==w?(i=()=>{if(!j.current||!w)return;let e=new IntersectionObserver(e=>{let[t]=e;C(t.boundingClientRect.top<0)},{threshold:1});return e.observe(j.current),()=>e.disconnect()},v[9]=w,v[10]=i):i=v[10],v[11]!==w||v[12]!==A?(o=[w,A],v[11]=w,v[12]=A,v[13]=o):o=v[13],(0,d.useEffect)(i,o);let[O,T]=(0,d.useState)(null);v[14]===Symbol.for("react.memo_cache_sentinel")?(a=()=>{T(null),window.dispatchEvent(new CustomEvent("sanity-overlay/exclusive-plugin-closed"))},v[14]=a):a=v[14];let P=a;v[15]===Symbol.for("react.memo_cache_sentinel")?(s=(e,t)=>{T({plugin:e,context:t})},v[15]=s):s=v[15];let R=s,L=O?.plugin.component,[N,D]=(0,d.useState)(!1);v[16]===Symbol.for("react.memo_cache_sentinel")?(c=()=>{D(!1)},v[16]=c):c=v[16],v[17]!==w?(p=[w],v[17]=w,v[18]=p):p=v[18],(0,d.useEffect)(c,p),v[19]!==L||v[20]!==N?(f=N||L?(0,u.jsx)(tc,{onDismiss:P,blockScroll:N}):null,v[19]=L,v[20]=N,v[21]=f):f=v[21];let z=b?"":void 0,U=w?"":void 0,V=A?"":void 0,F=g?"":void 0,Y=N?"":void 0;return v[22]!==L||v[23]!==O||v[24]!==w||v[25]!==e?(m=L?(0,u.jsx)(iq,{"data-sanity-overlay-element":!0,onClick:i0,children:(0,u.jsx)(L,{...O.context,closeExclusiveView:P})}):w?(0,u.jsx)(iB,{...e,onActivateExclusivePlugin:R,onMenuOpenChange:D}):null,v[22]=L,v[23]=O,v[24]=w,v[25]=e,v[26]=m):m=v[26],v[27]!==$||v[28]!==z||v[29]!==U||v[30]!==V||v[31]!==F||v[32]!==Y||v[33]!==m?(y=(0,u.jsx)(iD,{"data-focused":z,"data-hovered":U,"data-flipped":V,"data-draggable":F,"data-menu-open":Y,ref:j,style:$,children:m}),v[27]=$,v[28]=z,v[29]=U,v[30]=V,v[31]=F,v[32]=Y,v[33]=m,v[34]=y):y=v[34],v[35]!==f||v[36]!==y?(h=(0,u.jsxs)(u.Fragment,{children:[f,y]}),v[35]=f,v[36]=y,v[37]=h):h=v[37],h});function iH(e){return"object"==typeof e&&"component"in e?e:{component:e,props:{}}}let iX=(0,d.memo)(function(e){let t,n,r,i=(0,l.c)(6),o=(0,d.useSyncExternalStore)(i1,i2);i[0]!==e.href||i[1]!==o?(t=function e(t,n){try{let r=new URL(t,typeof location>"u"?void 0:location.origin);if(r.hash){let t=new URL(e(r.hash.slice(1),n));return`${r.origin}${r.pathname}${r.search}#${t.pathname}${t.search}`}return r.searchParams.set("preview",n),r.toString()}catch{return t}}(e.href,o),i[0]=e.href,i[1]=o,i[2]=t):t=i[2];let a=t;return i[3]===Symbol.for("react.memo_cache_sentinel")?(n=(0,u.jsx)(iY,{padding:2,children:(0,u.jsx)(M.EY,{size:1,weight:"medium",children:"Open in Studio"})}),i[3]=n):n=i[3],i[4]!==a?(r=(0,u.jsx)(M.az,{as:"a",href:a,target:"_blank",rel:"noopener noreferrer",children:n}),i[4]=a,i[5]=r):r=i[5],r});function iJ(e){return void 0!==e}function iK(e){return e.exclusive.length>0}function iZ(e){e.stopPropagation()}function iQ(e){return(0,u.jsx)(d.Fragment,{children:e.hud.map(t=>{let n=t.component;return n?(0,u.jsx)(n,{...e.context},t.name):null})},e.id)}function i0(e){e.stopPropagation()}function i1(e){let t=()=>e();return window.addEventListener("popstate",t),()=>window.removeEventListener("popstate",t)}function i2(){return window.location.href}let i3=e=>{let t,n=(0,l.c)(5),{dragGroupRect:r}=e,i=`${r.y}px`,o=`${r.x}px`,a=`${r.w-1}px`,s=`${r.h-1}px`;return n[0]!==i||n[1]!==o||n[2]!==a||n[3]!==s?(t=(0,u.jsx)("div",{style:{position:"absolute",top:i,left:o,width:a,height:s,border:"1px dashed #f0709b",pointerEvents:"none"}}),n[0]=i,n[1]=o,n[2]=a,n[3]=s,n[4]=t):t=n[4],t},i4=e=>{let t,n=(0,l.c)(4),{dragInsertPosition:r}=e;if(null===r)return;let i=r?.left||r?.right?"horizontal":"vertical",o=0,a=0,s=0,c=0;if("horizontal"===i){let{left:e,right:t}=r;if(s=6,t&&e){let n=e.rect.x+e.rect.w,r=t.rect.x,i=.0125*Math.min(t.rect.h,e.rect.h);o=.5*n+.5*r-3,a=e.rect.y+i,c=Math.min(t.rect.h,e.rect.h)-2*i}else if(t&&!e){let e=.0125*t.rect.h;o=t.rect.x-3,a=t.rect.y+e,c=t.rect.h-2*e}else if(e&&!t){let t=.0125*e.rect.h;o=e.rect.x+e.rect.w-3,a=e.rect.y+t,c=e.rect.h-2*t}}else{let{bottom:e,top:t}=r;if(e&&t){let n=Math.min(t.rect.x,e.rect.x),r=t.rect.y+t.rect.h,i=e.rect.y,u=.0125*Math.min(e.rect.w,t.rect.w);c=6,o=n+u,a=.5*r+.5*i-3,s=Math.max(e.rect.w,t.rect.w)-2*u}else if(e&&!t){let t=.0125*e.rect.w;o=e.rect.x+t,a=e.rect.y-3,s=e.rect.w-2*t,c=6}else if(t&&!e){let e=.0125*t.rect.w;o=t.rect.x+e,a=t.rect.y+t.rect.h-3,s=t.rect.w-2*e,c=6}}let d=`${s}px`,p=`${c}px`,f=`translate(${o}px, ${a}px)`;return n[0]!==d||n[1]!==p||n[2]!==f?(t=(0,u.jsx)("div",{style:{position:"absolute",width:d,height:p,transform:f,background:"#556bfc",border:"2px solid white",borderRadius:"999px",zIndex:"999999"}}),n[0]=d,n[1]=p,n[2]=f,n[3]=t):t=n[3],t},i5=$.I4.div`
  --drag-preview-opacity: 0.98;
  --drag-preview-skeleton-stroke: #ffffff;

  @media (prefers-color-scheme: dark) {
    --drag-preview-skeleton-stroke: #383d51;
  }

  position: fixed;
  display: grid;
  transform: ${({$scaleFactor:e,$width:t,$height:n})=>`translate(calc(var(--drag-preview-x) - ${t/2}px), calc(var(--drag-preview-y) - ${n/2}px)) scale(${e})`};
  width: ${({$width:e})=>`${e}px`};
  height: ${({$height:e})=>`${e}px`};
  z-index: 9999999;
  opacity: var(--drag-preview-opacity);
  cursor: move;

  .drag-preview-content-wrapper {
    position: relative;
    width: 100%;
    height: 100%;
    container-type: inline-size;
  }

  [data-ui='card'] {
    position: relative;
    width: 100%;
    height: 100%;
  }

  .drag-preview-skeleton {
    position: absolute;
    inset: 0;

    rect {
      stroke: var(--drag-preview-skeleton-stroke);
    }
  }

  .drag-preview-handle {
    position: absolute;
    top: 4cqmin;
    left: 4cqmin;
    width: 6cqmin;
    fill: var(--drag-preview-handle-fill);
  }
`,i6=e=>{let t,n,r,i,o,a,s,c,d,p,f,m,y,h,v,g,b,w,x,E,_,j=(0,l.c)(50),{skeleton:k}=e,I=Math.min(k.maxWidth,window.innerWidth/2),S=k.w>I?I/k.w:1,$=k.offsetX*S,A=k.offsetY*S,C=(0,M.Xy)(),O=(0,M.M4)(),T=O.radius[~~function(e,t,n,r,i){var o;return o=(e-0)*(i-1)/1920+1,o<r?r:o>i?i:o}(k.w,0,0,1,O.radius.length-2)];if(j[0]!==$||j[1]!==A||j[2]!==C||j[3]!==T||j[4]!==S||j[5]!==k.childRects||j[6]!==k.h||j[7]!==k.w){let e=k.childRects.filter(i9),u=k.childRects.filter(i8);n=i5,i=k.w,o=k.h,a=$,s=A,c=S,t=M.Zp,m=T,y=4,h="hidden",v="transparent",g=C?"dark":"light",f="drag-preview-content-wrapper",d="drag-preview-skeleton",p=`0 0 ${k.w} ${k.h}`,r=[...e,...u],j[0]=$,j[1]=A,j[2]=C,j[3]=T,j[4]=S,j[5]=k.childRects,j[6]=k.h,j[7]=k.w,j[8]=t,j[9]=n,j[10]=r,j[11]=i,j[12]=o,j[13]=a,j[14]=s,j[15]=c,j[16]=d,j[17]=p,j[18]=f,j[19]=m,j[20]=y,j[21]=h,j[22]=v,j[23]=g}else t=j[8],n=j[9],r=j[10],i=j[11],o=j[12],a=j[13],s=j[14],c=j[15],d=j[16],p=j[17],f=j[18],m=j[19],y=j[20],h=j[21],v=j[22],g=j[23];return j[24]!==r||j[25]!==O.color?(b=r.map((e,t)=>(0,u.jsx)("rect",{x:e.x,y:e.y,width:e.w,height:e.h,fill:O.color.skeleton.from},t)),j[24]=r,j[25]=O.color,j[26]=b):b=j[26],j[27]!==b||j[28]!==d||j[29]!==p?(w=(0,u.jsx)("svg",{className:d,viewBox:p,children:b}),j[27]=b,j[28]=d,j[29]=p,j[30]=w):w=j[30],j[31]!==w||j[32]!==f?(x=(0,u.jsx)("div",{className:f,children:w}),j[31]=w,j[32]=f,j[33]=x):x=j[33],j[34]!==t||j[35]!==x||j[36]!==m||j[37]!==y||j[38]!==h||j[39]!==v||j[40]!==g?(E=(0,u.jsx)(t,{radius:m,shadow:y,overflow:h,tone:v,scheme:g,children:x}),j[34]=t,j[35]=x,j[36]=m,j[37]=y,j[38]=h,j[39]=v,j[40]=g,j[41]=E):E=j[41],j[42]!==n||j[43]!==i||j[44]!==o||j[45]!==a||j[46]!==s||j[47]!==c||j[48]!==E?(_=(0,u.jsx)(n,{$width:i,$height:o,$offsetX:a,$offsetY:s,$scaleFactor:c,children:E}),j[42]=n,j[43]=i,j[44]=o,j[45]=a,j[46]=s,j[47]=c,j[48]=E,j[49]=_):_=j[49],_};function i9(e){return"IMG"===e.tagName}function i8(e){return"IMG"!==e.tagName}let i7=(0,$.I4)(M.Zp)`
  position: fixed;
  bottom: 2rem;
  left: 2rem;
`,oe=()=>{let e,t,n=(0,l.c)(2);return n[0]===Symbol.for("react.memo_cache_sentinel")?(e={zIndex:"999999"},n[0]=e):e=n[0],n[1]===Symbol.for("react.memo_cache_sentinel")?(t=(0,u.jsx)(i7,{padding:2,shadow:2,radius:2,style:e,children:(0,u.jsxs)(M.so,{align:"center",gap:2,children:[(0,u.jsx)(M.qW,{keys:["Shift"]}),(0,u.jsx)(M.EY,{size:1,children:"Zoom Out"}),(0,u.jsx)(ti.mSu,{})]})}),n[1]=t):t=n[1],t};function ot(e,t){let{type:n}=t,{contextMenu:r,focusPath:i,perspective:o,isDragging:a,dragInsertPosition:s,dragShowMinimap:u,dragShowMinimapPrompt:l,dragSkeleton:c,dragMinimapTransition:d,dragGroupRect:p}=e,f=!1;if("presentation/focus"===n){let n=e.focusPath;n!==(i=t.data.path)&&(f=n.slice(i.length).startsWith("["))}return"presentation/perspective"===n&&(o=t.data.perspective),"element/contextmenu"===n&&(r="sanity"in t?{node:t.sanity,position:t.position}:null),("element/click"===n||"element/mouseleave"===n||"overlay/blur"===n||"presentation/blur"===n||"presentation/focus"===n)&&(r=null),"overlay/dragUpdateInsertPosition"===n&&(s=t.insertPosition),"overlay/dragStart"===n&&(a=!0),"overlay/dragUpdateSkeleton"===t.type&&(c=t.skeleton),"overlay/dragEnd"===n&&(a=!1),"overlay/dragToggleMinimapPrompt"===t.type&&(l=t.display),"overlay/dragStartMinimapTransition"===n&&(d=!0),"overlay/dragEndMinimapTransition"===n&&(d=!1),"overlay/dragUpdateGroupRect"===n&&(p=t.groupRect),"overlay/dragToggleMinimap"===n&&(u=t.display),{...e,contextMenu:r,elements:((e,t)=>{let{type:n}=t;switch(n){case"element/register":return e.find(e=>e.id===t.id)?e:[...e,{id:t.id,activated:!1,element:t.element,focused:!1,hovered:!1,rect:t.rect,sanity:t.sanity,dragDisabled:t.dragDisabled,targets:t.targets,elementType:t.elementType}];case"element/activate":return e.map(e=>e.id===t.id?{...e,activated:!0}:e);case"element/update":return e.map(e=>e.id===t.id?{...e,sanity:t.sanity,rect:t.rect,targets:t.targets,elementType:t.elementType}:e);case"element/unregister":return e.filter(e=>e.id!==t.id);case"element/deactivate":return e.map(e=>e.id===t.id?{...e,activated:!1,hovered:!1}:e);case"element/mouseenter":return e.map(e=>e.id===t.id?{...e,rect:t.rect,hovered:!0}:{...e,hovered:!1});case"element/mouseleave":return e.map(e=>e.id===t.id?{...e,hovered:!1}:e);case"element/updateRect":return e.map(e=>e.id===t.id?{...e,rect:t.rect}:e);case"element/click":return e.map(e=>({...e,focused:e.id===t.id&&"clicked"}));case"overlay/reset-mouse-state":return e.map(e=>({...e,focused:!1,hovered:!1}));case"overlay/blur":return e.map(e=>({...e,focused:!1}));case"presentation/blur":return e.map(e=>({...e,focused:!1}));case"presentation/focus":{let n=e.find(e=>"clicked"===e.focused);return e.map(e=>{let r="path"in e.sanity&&e.sanity.id===t.data.id&&e.sanity.path===t.data.path;return n&&e===n&&r?e:{...e,focused:r&&n?"duplicate":r}})}default:return e}})(e.elements,t),dragInsertPosition:s,dragSkeleton:c,dragGroupRect:p,isDragging:a,focusPath:i,perspective:o,wasMaybeCollapsed:f,dragShowMinimap:u,dragShowMinimapPrompt:l,dragMinimapTransition:d}}let on=function(e){let t,n,r,i,o,a,s,c=(0,l.c)(13),{comlink:p,children:f}=e;c[0]===Symbol.for("react.memo_cache_sentinel")?(t=[],c[0]=t):t=c[0];let[m,y]=(0,d.useState)(t);c[1]!==p?(n=async e=>{if(p)try{let t=await p.fetch("visual-editing/preview-snapshots",void 0,{signal:e,suppressWarnings:!0});y(t.snapshots)}catch{}},c[1]=p,c[2]=n):n=c[2];let h=n;return c[3]!==p||c[4]!==h?(r=()=>{if(!p)return;let e=new AbortController,t=p.onStatus(()=>{h(e.signal)},"connected");return()=>{e.abort(),t()}},i=[p,h],c[3]=p,c[4]=h,c[5]=r,c[6]=i):(r=c[5],i=c[6]),(0,d.useEffect)(r,i),c[7]!==p?(o=()=>p?.on("presentation/preview-snapshots",e=>{y(e.snapshots)}),a=[p],c[7]=p,c[8]=o,c[9]=a):(o=c[8],a=c[9]),(0,d.useEffect)(o,a),c[10]!==f||c[11]!==m?(s=(0,u.jsx)(iN.Provider,{value:m,children:f}),c[10]=f,c[11]=m,c[12]=s):s=c[12],s};function or(e){return"document"===e.type}function oi(e){return"type"===e.type}let oo=function(e){let t,n,r,i,o,a,s,c,p,f,m,y=(0,l.c)(22),{comlink:h,children:v,elements:g}=e;y[0]===Symbol.for("react.memo_cache_sentinel")?(t=new Map,y[0]=t):t=y[0];let[b,w]=(0,d.useState)(t),[x,E]=(0,d.useState)(null);y[1]!==h?(n=()=>{if(!h)return;let e=async function(e){if(h)try{let t=await h.fetch("visual-editing/schema",void 0,{signal:e,suppressWarnings:!0});E(t.schema)}catch{}},t=new AbortController,n=h.onStatus(()=>{e(t.signal)},"connected");return()=>{t.abort(),n()}},r=[h],y[1]=h,y[2]=n,y[3]=r):(n=y[2],r=y[3]),(0,d.useEffect)(n,r),y[4]===Symbol.for("react.memo_cache_sentinel")?(i=[],y[4]=i):i=y[4];let _=(0,d.useRef)(i),j=(0,d.useDeferredValue)(g);y[5]!==j?(o=j.reduce((e,t)=>{let{sanity:n}=t;if(!("id"in n)||!n.path.includes("[_key=="))return e;let r=n.path.split(".").toReversed().reduce((e,t)=>e.length?[t,...e]:t.includes("[_key==")?[t]:[],[]).join(".");return e.find(e=>e.id===n.id&&e.path===r)||e.push({id:n.id,path:r}),e},[]),y[5]=j,y[6]=o):o=y[6];let k=o,I=(0,d.useRef)(null);y[7]!==h||y[8]!==k?(a=()=>{if(!k.length||!h)return;let e=async(e,t)=>{let n=_.current;try{_.current=e;let n=await h.fetch("visual-editing/schema-union-types",{paths:e},{signal:t,suppressWarnings:!0});if(t.aborted)return;w(n.types),I.current=null}catch{}t.aborted&&(_.current=n)};k.some(e=>!_.current.find(t=>{let{id:n,path:r}=t;return n===e.id&&r===e.path}))&&(I.current?.abort(),I.current=new AbortController,e(k,I.current.signal))},s=[h,k],y[7]=h,y[8]=k,y[9]=a,y[10]=s):(a=y[9],s=y[10]),(0,d.useEffect)(a,s),y[11]!==x?(c=(e,t)=>{if(!x||"string"!=typeof e&&(!("path"in e)||!Array.isArray(x)))return;let n="string"==typeof e?e:e.type;return x.filter("document"===(t||"document")?or:oi).find(e=>e.name===n)},y[11]=x,y[12]=c):c=y[12];let S=c;y[13]!==S||y[14]!==b?(p=e=>{if(!("path"in e))return{field:void 0,parent:void 0};let t=S(e);if(!t)return{field:void 0,parent:void 0};let n=e.path.split(".").flatMap(oa);try{return function t(n,r,i,o){let a=void 0===o?[]:o;if(!n)return{field:void 0,parent:void 0};let[s,...u]=r;if("fields"in n){let e=n.fields[s];if(!e&&"rest"in n)return t(n.rest,r,n,a);if(!u.length)return{field:e,parent:i};if(!e)throw Error(`[@sanity/visual-editing] No field could be resolved at path: "${[...a,...r].join(".")}"`);return t(e.value,u,n,[...a,s])}if("array"===n.type)return t(n.of,r,n,a);if("arrayItem"===n.type)return u.length?t(n.value,u,n,[...a,s]):{field:n,parent:i};if("union"===n.type){let r=s.startsWith("[_key==")?b?.get(e.id)?.get([a.join("."),s].filter(Boolean).join("")):s;return t(n.of.find(e=>"unionOption"===e.type?e.name===r:e),u,n,[...a,s])}if("unionOption"===n.type)return s?t(n.value,r,n,a):{field:n,parent:i};if("inline"===n.type)return t(S(n.name,"type").value,r,n,a);throw Error(`[@sanity/visual-editing] No field could be resolved at path: "${[...a,...r].join(".")}"`)}(t,n,void 0)}catch(e){return e instanceof Error&&console.warn(e.message),{field:void 0,parent:void 0}}},y[13]=S,y[14]=b,y[15]=p):p=y[15];let M=p;y[16]!==M||y[17]!==S?(f={getField:M,getType:S},y[16]=M,y[17]=S,y[18]=f):f=y[18];let $=f;return y[19]!==v||y[20]!==$?(m=(0,u.jsx)(ik.Provider,{value:$,children:v}),y[19]=v,y[20]=$,y[21]=m):m=y[21],m};function oa(e){return e.includes("[")?e.split(/(\[.+\])/,2):[e]}let os=(e=>{let t=e,n=new Set;return{getState:()=>t,setState:e=>{t=e(t),n.forEach(e=>e())},subscribe:e=>(n.add(e),()=>n.delete(e))}})({}),ou=e=>{let t,n,r,i,o,a,s=(0,l.c)(11),{comlink:c,children:p}=e;s[0]!==c?(t=()=>c?.on("presentation/shared-state",ol),n=[c],s[0]=c,s[1]=t,s[2]=n):(t=s[1],n=s[2]),(0,d.useEffect)(t,n),s[3]!==c?(r=()=>{(async function(){let e=await c?.fetch("visual-editing/shared-state",void 0,{suppressWarnings:!0});e&&os.setState(()=>e.state)})().catch(oc)},i=[c],s[3]=c,s[4]=r,s[5]=i):(r=s[4],i=s[5]),(0,d.useEffect)(r,i),s[6]!==c?(o={comlink:c,store:os},s[6]=c,s[7]=o):o=s[7];let f=o;return s[8]!==p||s[9]!==f?(a=(0,u.jsx)(tn.Provider,{value:f,children:p}),s[8]=p,s[9]=f,s[10]=a):a=s[10],a};function ol(e){"value"in e?os.setState(t=>({...t,[e.key]:e.value})):os.setState(t=>Object.fromEntries(Object.entries(t).filter(t=>{let[n]=t;return n!==e.key})))}function oc(e){console.debug(e),console.warn("[@sanity/visual-editing]: Failed to fetch shared state. Check your version of `sanity` is up-to-date")}let od=e=>{let t,n,r=(0,l.c)(5),{children:i,comlink:o}=e;r[0]!==o?(t=(e,t)=>{if(!o)return;let n=tf[e];if(n)o.post("visual-editing/telemetry-log",{event:n,data:t});else throw Error(`Telemetry event: ${e} does not exist`)},r[0]=o,r[1]=t):t=r[1];let a=t;return r[2]!==i||r[3]!==a?(n=(0,u.jsx)(tm.Provider,{value:a,children:i}),r[2]=i,r[3]=a,r[4]=n):n=r[4],n};function op(){}function of(e){return e.id}function om(e){return!!e}function oy(e){let{sanity:t}=e;return t&&"id"in t?t:null}let oh=$.I4.div`
  background-color: transparent;
  direction: ltr;
  inset: 0;
  pointer-events: none;
  position: absolute;
  width: 100%;
  height: 100%;
  z-index: ${({$zIndex:e})=>e??"9999999"};
`;function ov(e){let t,n;return t=requestAnimationFrame(()=>{n=requestAnimationFrame(e)}),()=>{void 0!==t&&cancelAnimationFrame(t),void 0!==n&&cancelAnimationFrame(n)}}let og=e=>{let t,n,r,i,o,a=(0,l.c)(8),{documentIds:s}=e;a[0]===Symbol.for("react.memo_cache_sentinel")?(t=[],a[0]=t):t=a[0];let[u,c]=(0,d.useState)(t);a[1]!==s?(n=()=>{c(e=>{let t=Array.from(new Set(s));return e.length===t.length&&e.reduce(o_,t)?.length===0?e:t})},r=[s],a[1]=s,a[2]=n,a[3]=r):(n=a[2],r=a[3]),(0,d.useEffect)(n,r);let p=ei();return a[4]!==p||a[5]!==u?(i=()=>{for(let e of u)p.send({type:"observe",documentId:I(e)}),p.send({type:"observe",documentId:S(e)});return()=>{for(let e of u)p.send({type:"unobserve",documentId:I(e)}),p.send({type:"unobserve",documentId:S(e)})}},o=[p,u],a[4]=p,a[5]=u,a[6]=i,a[7]=o):(i=a[6],o=a[7]),(0,d.useEffect)(i,o),null},ob=e=>{let{comlink:t,dispatch:n,inFrame:r,inPopUp:i,onDrag:o,overlayEnabled:a,rootElement:s}=e,{dispatchDragEndEvent:u}=function(){let e,t,n,r=(0,l.c)(4),{getDocument:i}=ec();return r[0]!==i?(e=()=>{let e=e=>{let{insertPosition:t,target:n,preventInsertDefault:r}=e.detail;if(r)return;let o=function(e){if(e){let{top:t,right:n,bottom:r,left:i}=e;if(i||t)return{node:(i??t).sanity,position:"after"};if(n||r)return{node:(n??r).sanity,position:"before"}}}(t);if(o){let e=i(n.id),{node:t,position:r}=o,{key:a,hasExplicitKey:s}=ef(n),{path:u,key:l}=ef(t);u&&l&&l!==a&&e.patch(async e=>{let{getSnapshot:t}=e,i=en(await t(),n.path);return s?[W(u,Y({_key:a})),W(u,V(i,r,{_key:l}))]:[W(u,Y(~~a)),W(u,V(i,r,l>a?~~l-1:~~l))]})}};return window.addEventListener("sanity/dragEnd",e),()=>{window.removeEventListener("sanity/dragEnd",e)}},t=[i],r[0]=i,r[1]=e,r[2]=t):(e=r[1],t=r[2]),(0,d.useEffect)(e,t),r[3]===Symbol.for("react.memo_cache_sentinel")?(n={dispatchDragEndEvent:ij},r[3]=n):n=r[3],n}(),c=ty(),p=function(e,t,n,r){let i,o,a=(0,l.c)(7),s=(0,d.useRef)(void 0),u=ei()!==B;return a[0]!==e||a[1]!==t||a[2]!==n||a[3]!==r||a[4]!==u?(i=()=>{if(e)return s.current=function({handler:e,overlayElement:t,inFrame:n,inPopUp:r,optimisticActorReady:i}){let o=!1,a=new Map,s=new WeakMap,u=new Set,l=new WeakMap,c=new WeakMap,d,p,f,m=!1,y=[],h=()=>y[y.length-1];function v(e,t){e.removeEventListener("click",t.click,{capture:!0}),e.removeEventListener("contextmenu",t.contextmenu,{capture:!0}),e.removeEventListener("mousemove",t.mousemove,{capture:!0}),e.removeEventListener("mousedown",t.mousedown,{capture:!0}),e.removeEventListener("mouseenter",t.mouseenter),e.removeEventListener("mouseleave",t.mouseleave)}function g({id:t,elements:n,handlers:r}){let{element:i,measureElement:o}=n;i.addEventListener("click",r.click,{capture:!0}),i.addEventListener("contextmenu",r.contextmenu,{capture:!0}),i.addEventListener("mousemove",r.mousemove,{once:!0,capture:!0}),i.addEventListener("mousedown",r.mousedown,{capture:!0}),d.observe(o),e({type:"element/activate",id:t})}function b({id:t,elements:n,handlers:r}){let{element:i,measureElement:o}=n;v(i,r),d.unobserve(o),y=y.filter(e=>e!==i),e({type:"element/deactivate",id:t})}function w(t){if(!(!n&&!r||!i))for(let n of y){if(t===n){let n=s.get(t)?.sanity;if(!n||!e6(n))return;if(tt(t,n,u,s)){let n=t.style.cursor;n&&c.set(t,n),e({type:"overlay/setCursor",element:t,cursor:"move"});continue}}x(n)}}function x(t){let n=c.get(t);e({type:"overlay/setCursor",element:t,cursor:n})}function E(c){for(let d of function e(t){let n=[];function r(e,t,n,r){let i=function(e){if("object"==typeof e&&null!==e)return ek(e);try{let t=JSON.parse(e);return ek(t)}catch{let t=e.split(";").reduce((e,t)=>{let[n,r]=t.split("=");if(!n||t.includes("=")&&!r)return e;switch(n){case"id":e.id=r;break;case"type":e.type=r;break;case"path":e.path=ey.C.toString(function(e){let t=[];for(let n of e.split(".")){let e=ew.exec(n);if(e){t.push(e[1],Number(e[2]));continue}let r=ex.exec(n);if(r){t.push(r[1],[Number(r[2]),Number(r[3])]);continue}let i=eE.exec(n);if(i){t.push(i[1],{_key:i[2]});continue}t.push(n)}return t}(r));break;case"base":e.baseUrl=decodeURIComponent(r);break;case"tool":e.tool=r;break;case"workspace":e.workspace=r;break;case"projectId":e.projectId=r;break;case"dataset":e.dataset=r}return e},{});if((0,eh.is)(eb,t))return t;return}}(t);if(!i)return;let o=function e(t){let{display:n}=window.getComputedStyle(t);if("inline"!==n)return t;let r=t.parentElement;return r?e(r):null}(e);if(o)return{elements:{element:e,measureElement:o},sanity:i,reason:n,preventGrouping:r}}if(t)for(let i of t.childNodes)!function t(i,o){let a=function(t){let{nodeType:n,parentElement:i,textContent:o}=t;if(t.nodeType===Node.ELEMENT_NODE&&t.dataset?.sanityEditTarget!==void 0){let n=e9(e(t).map(e=>"element"===e.type?e.commonSanity:void 0).filter(e=>void 0!==e));if(n)return{reason:"edit-target",elements:{element:t,measureElement:t},sanity:n}}else if(n===Node.TEXT_NODE&&i&&o){let e=e5(o);return e?r(i,e,"stega-text",!0):void 0}else if(t.nodeType===Node.ELEMENT_NODE){if("SCRIPT"===t.tagName||"SANITY-VISUAL-EDITING"===t.tagName)return;if(t.dataset?.sanity)return r(t,t.dataset.sanity,"data-attribute",!!(t.textContent&&e4(t.textContent)));if(t.dataset?.sanityEditInfo)return r(t,t.dataset.sanityEditInfo,"data-attribute",!!(t.textContent&&e4(t.textContent)));if("IMG"===t.tagName){let e=e5(t.alt,!0);return e?r(t,e,"stega-attribute"):void 0}if("TIME"===t.tagName){let e=e5(t.dateTime,!0);return e?r(t,e,"stega-attribute"):void 0}if("SVG"===t.tagName.toUpperCase()){if(!t.ariaLabel)return;let e=e5(t.ariaLabel,!0);return e?r(t,e,"stega-attribute"):void 0}}}(i),s=o;if(i.nodeType===Node.ELEMENT_NODE&&i.dataset?.sanityEditGroup!==void 0&&(s={type:"group",elements:{element:i,measureElement:i},targets:[]},n.push(s)),a){let e={elements:a.elements,sanity:a.sanity,reason:a.reason};s&&!a.preventGrouping?s.targets.push(e):n.push({elements:a.elements,type:"element",targets:[e]})}if(i.nodeType===Node.ELEMENT_NODE&&"IMG"!==i.tagName&&"SCRIPT"!==i.tagName&&"SANITY-VISUAL-EDITING"!==i.tagName)for(let e of i.childNodes)t(e,s)}(i,void 0);return n.map(e=>{if(0===e.targets.length&&"group"===e.type)return{...e,commonSanity:void 0};let t=1===e.targets.length?e.targets[0].sanity:e9(e.targets.map(({sanity:e})=>e).filter(e=>void 0!==e))||e.targets[0].sanity;return t?{...e,commonSanity:t}:null}).filter(e=>null!==e)}(c)){if("group"===d.type){for(let e of d.targets){let t=s.get(e.elements.element);t&&"element"===t.type&&_(e.elements.element)}0===d.targets.length&&_(d.elements.element)}if(!d.commonSanity)continue;let{element:c}=d.elements;s.has(c)?function(t){let{element:n}=t.elements,r=s.get(n);r&&(s.set(n,{...r,sanity:t.commonSanity}),e({type:"element/update",elementType:r.type,id:r.id,rect:eN(n),sanity:t.commonSanity,targets:t.targets.map(e=>({sanity:e.sanity,element:e.elements.element}))}))}(d):function({type:c,elements:d,commonSanity:f,targets:v}){let{element:b,measureElement:E}=d,_={click(t){let r=t.target;if(b===h()&&b.contains(r)){n&&(t.preventDefault(),t.stopPropagation());let r=s.get(b)?.sanity;r&&!m&&e({type:"element/click",id:j,sanity:r})}},contextmenu(t){if(!("path"in f)||!n&&!r||!i||!f.path.split(".").pop()?.includes("[_key=="))return;let o=t.target;b===h()&&b.contains(o)&&((n||r)&&(t.preventDefault(),t.stopPropagation()),e({type:"element/contextmenu",id:j,position:{x:t.clientX,y:t.clientY},sanity:f}))},mousedown(t){if(t.preventDefault(),t.currentTarget!==y.at(-1)||b.getAttribute("data-sanity-drag-disable")||!n&&!r||!i)return;let o=s.get(b)?.sanity;if(!o||!e6(o)||!e8(o.path))return;let a=tt(b,f,u,s);a&&function(e){var t;let{mouseEvent:n,element:r,overlayGroup:i,handler:o,target:a,onSequenceStart:s,onSequenceEnd:u}=e;if(0!==n.button)return;window.focus();let l=i.map(e=>eN(e.elements.element)),c=r.getAttribute("data-sanity-drag-flow")||((t=l).some(e=>t.filter(t=>!ez(e,t)).some(t=>e.y===t.y))?"horizontal":"vertical"),d=r.getAttribute("data-sanity-drag-group"),p=!!r.getAttribute("data-sanity-drag-minimap-disable"),f=!!r.getAttribute("data-sanity-drag-prevent-default"),m=r.getAttribute("data-unstable_sanity-drag-document-height"),y=r.getAttribute("data-unstable_sanity-drag-group-height"),h=null,v=eB(n),g=document.body,{minYScaled:b,scaleFactor:w}=function(e,t){let n=t||eY(e).height,r=(n+=200)>window.innerHeight?window.innerHeight/n:1,{min:i}=eY(e.map(e=>eF(e,r,{x:window.innerWidth/2,y:0})));return{scaleFactor:r,minYScaled:i-100*r}}(l,y?~~y:null),x=!1,E=!1,_=!0;eK||(e1={body:{overflow:window.getComputedStyle(document.body).overflow,height:window.getComputedStyle(document.body).height},documentElement:{overflow:window.getComputedStyle(document.documentElement).overflow,height:window.getComputedStyle(document.documentElement).height}},e0=m?~~m:document.documentElement.scrollHeight);let j=setInterval(()=>{l=i.map(e=>eN(e.elements.element))},150),k=()=>{w>=1||(o({type:"overlay/dragUpdateSkeleton",skeleton:eG(eQ,r,w)}),o({type:"overlay/dragToggleMinimapPrompt",display:!1}),eH(g,w,b,o,150).then(()=>{setTimeout(()=>{o({type:"overlay/dragUpdateGroupRect",groupRect:eX(l)})},300)}))},I=e=>{Math.abs(e.deltaY)>=10&&w<1&&!eK&&!E&&!p&&_&&(o({type:"overlay/dragToggleMinimapPrompt",display:!0}),E=!0),!e.shiftKey||eK||p||(window.dispatchEvent(new CustomEvent("unstable_sanity/dragApplyMinimap")),eK=!0,setTimeout(()=>{k()},50))},S=e=>{if(e.preventDefault(),eZ=function(e){let t=document.body,n=window.getComputedStyle(t).transform;if("none"===n)return{x:e.x,y:e.y};let r=new DOMMatrix(n).inverse(),i=new DOMPoint(e.x,e.y).matrixTransform(r);return{x:i.x,y:i.y}}(eQ=eB(e)),4>Math.abs(eU(eQ,v)))return;if(!x){let e=eX(l),t=eG(eQ,r,1);o({type:"overlay/dragStart",flow:c}),o({type:"overlay/dragUpdateSkeleton",skeleton:t}),o({type:"overlay/dragUpdateGroupRect",groupRect:e}),x=!0,s()}o({type:"overlay/dragUpdateCursorPosition",x:eQ.x,y:eQ.y}),!e.shiftKey||eK||p||(window.dispatchEvent(new CustomEvent("unstable_sanity/dragApplyMinimap")),eK=!0,setTimeout(()=>{k()},50));let t=function(e,t,n){if("horizontal"===n){let r={x1:e.x,y1:e.y,x2:e.x-1e8,y2:e.y},i={x1:e.x,y1:e.y,x2:e.x+1e8,y2:e.y};return{left:eV(r,t,n),right:eV(i,t,n)}}{let r={x1:e.x,y1:e.y,x2:e.x,y2:e.y-1e8},i={x1:e.x,y1:e.y,x2:e.x,y2:e.y+1e8};return{top:eV(r,t,n),bottom:eV(i,t,n)}}}(eQ,l,c);JSON.stringify(h)!==JSON.stringify(t)&&o({type:"overlay/dragUpdateInsertPosition",insertPosition:eq(i,h=t,c)})},M=()=>{_=!1,o({type:"overlay/dragEnd",target:a,insertPosition:h?eq(i,h,c):null,dragGroup:d,flow:c,preventInsertDefault:f}),E&&o({type:"overlay/dragToggleMinimapPrompt",display:!1}),eK||(clearInterval(j),u(),T(),O()),C()},$=e=>{"Shift"===e.key&&eK&&(eK=!1,o({type:"overlay/dragUpdateSkeleton",skeleton:eG(eQ,r,1/w)}),window.dispatchEvent(new CustomEvent("unstable_sanity/dragResetMinimap")),setTimeout(()=>{eJ(eZ.y,g,e0,o,150,e1)},50),o({type:"overlay/dragUpdateGroupRect",groupRect:null}),_||(clearInterval(j),C(),T(),O(),u()))},A=()=>{o({type:"overlay/dragUpdateGroupRect",groupRect:null}),window.dispatchEvent(new CustomEvent("unstable_sanity/dragResetMinimap")),setTimeout(()=>{eJ(eZ.y,g,e0,o,150,e1).then(()=>{eK=!1})},50),clearInterval(j),C(),T(),O(),u()},C=()=>{window.removeEventListener("mousemove",S),window.removeEventListener("wheel",I),window.removeEventListener("mouseup",M)},O=()=>{window.removeEventListener("keyup",$)},T=()=>{window.removeEventListener("blur",A)};window.addEventListener("blur",A),window.addEventListener("keyup",$),window.addEventListener("wheel",I),window.addEventListener("mousemove",S),window.addEventListener("mouseup",M)}({element:b,handler:e,mouseEvent:t,overlayGroup:a,target:o,onSequenceStart:()=>{m=!0},onSequenceEnd:()=>{setTimeout(()=>{m=!1},250)}})},mousemove(e){_.mouseenter(e);let t=e.currentTarget;t&&(t.addEventListener("mouseenter",_.mouseenter),t.addEventListener("mouseleave",_.mouseleave))},mouseenter(){document.querySelector("vercel-live-feedback")&&b.closest("[data-vercel-edit-info]")||b.closest("[data-vercel-edit-target]")||(y.push(b),e({type:"element/mouseenter",id:j,rect:eN(b)}),w(b))},mouseleave(n){function r(){y.pop();let t=h();if(e({type:"element/mouseleave",id:j}),t){w(t);let n=s.get(t);n&&e({type:"element/mouseenter",id:n.id,rect:eN(t)})}x(b)}let{relatedTarget:i}=n,o=e3(i),a=t.contains(o);if(e2(o)&&a)return function e(t){let n=i=>{let{relatedTarget:o}=i;e3(o)?o&&e2(o)&&(t.removeEventListener("mouseleave",n),e(o)):(t.removeEventListener("mouseleave",n),r())};t.addEventListener("mouseleave",n)}(o);r()}},j=eL(),k={type:c,id:j,elements:d,sanity:f,handlers:_};u.add(b),l.set(E,b),a.set(j,b),s.set(b,k),p?.observe(b),e({type:"element/register",elementType:c,id:j,element:b,rect:eN(b),sanity:f,dragDisabled:!!b.getAttribute("data-sanity-drag-disable"),targets:v.map(e=>({sanity:e.sanity,element:e.elements.element}))}),o&&g(k)}(d)}}function _(t){let n=s.get(t);if(n){let{id:r,handlers:i}=n;v(t,i),d.unobserve(t),s.delete(t),u.delete(t),a.delete(r),e({type:"element/unregister",id:r})}}function j(t){let n=s.get(t);n&&e({type:"element/updateRect",id:n.id,rect:eN(t)})}function k(e){if(o)for(let t of e){let{target:e}=t,n=e2(e)&&s.get(e);n&&(t.isIntersecting?g(n):b(n))}}function I(t){let n=e3(t.target);if(n){"capture"===n.dataset.sanityOverlayElement&&(t.preventDefault(),t.stopPropagation());return}y=[],e({type:"overlay/blur"})}function S(){y=[],e({type:"overlay/reset-mouse-state"})}function M(){for(let e of u)j(e)}function $(t){"Escape"===t.key&&(y=[],e({type:"overlay/blur"}))}function A(e){let{target:t}=e;if(!(t===window.document||!e2(t)))for(let e of u)t.contains(e)&&j(e)}function C(){o||(p=new IntersectionObserver(k,{threshold:.3}),u.forEach(e=>p.observe(e)),e({type:"overlay/activate"}),o=!0)}function O(){o&&(p?.disconnect(),u.forEach(e=>{let t=s.get(e);t&&b(t)}),e({type:"overlay/deactivate"}),o=!1)}function T(t){let{id:n}=t.detail,r=a.get(n);if(!r)return;let i=s.get(r)?.sanity;i&&e({type:"element/click",id:n,sanity:i})}return window.document.fonts.ready.then(()=>{for(let e of u)j(e)}),window.addEventListener("click",I),window.addEventListener("contextmenu",I),window.addEventListener("sanity-overlay/exclusive-plugin-closed",S),window.addEventListener("sanity-overlay/label-click",T),window.addEventListener("keydown",$),window.addEventListener("resize",M),window.addEventListener("scroll",A,{capture:!0,passive:!0}),d=new ResizeObserver(function(e){for(let t of e){let e=t.target;if(e2(e)){let t=l.get(e);if(!t)return;j(t)}}}),(f=new MutationObserver(function(e){let n=!1;for(let r of e){let{target:e,type:i}=r,o="characterData"===i?e.parentElement:e;if(!(o===t||t.contains(o))&&(n=!0,e2(o))){let e=o.parentElement?.closest("[data-sanity-edit-group]")||null;E({childNodes:[e2(e)?e:o]})}}if(n)for(let e of u)e.isConnected||_(e),s.get(e)?.type!=="group"||e.hasAttribute("data-sanity-edit-group")||_(e)})).observe(document.body,{attributes:!0,characterData:!0,childList:!0,subtree:!0}),E(document.body),C(),{activate:C,deactivate:O,destroy:function(){window.removeEventListener("click",I),window.removeEventListener("contextmenu",I),window.removeEventListener("sanity-overlay/exclusive-plugin-closed",S),window.removeEventListener("sanity-overlay/label-click",T),window.removeEventListener("keydown",$),window.removeEventListener("resize",M),window.removeEventListener("scroll",A),f.disconnect(),d.disconnect(),u.forEach(e=>{_(e)}),a.clear(),u.clear(),y=[],O()}}}({handler:t,overlayElement:e,inFrame:n,inPopUp:r,optimisticActorReady:u}),()=>{s.current?.destroy(),s.current=void 0}},o=[e,t,n,r,u],a[0]=e,a[1]=t,a[2]=n,a[3]=r,a[4]=u,a[5]=i,a[6]=o):(i=a[5],o=a[6]),(0,d.useEffect)(i,o),s}(s,(0,d.useCallback)(e=>{if("element/click"===e.type){let{sanity:n}=e;t?.post("visual-editing/focus",n),c("Visual Editing Overlay Clicked",null)}else if("overlay/activate"===e.type)t?.post("visual-editing/toggle",{enabled:!0});else if("overlay/deactivate"===e.type)t?.post("visual-editing/toggle",{enabled:!1});else if("overlay/dragEnd"===e.type){let{insertPosition:t,target:n,dragGroup:r,flow:i,preventInsertDefault:o}=e;u({insertPosition:t,target:n,dragGroup:r,flow:i,preventInsertDefault:o}),t&&c("Visual Editing Drag Sequence Completed",null)}else if("overlay/dragUpdateCursorPosition"===e.type)return void o(e.x,e.y);else if("overlay/dragToggleMinimap"===e.type&&!0===e.display)c("Visual Editing Drag Minimap Enabled",null);else if("overlay/setCursor"===e.type){let{element:t,cursor:n}=e;n?t.style.cursor=n:t.style.removeProperty("cursor")}n(e)},[t,n,u,o,c]),r,i);return(0,d.useEffect)(()=>{a?p.current?.activate():p.current?.deactivate()},[p,a]),null},ow=e=>{let t,n,r,i,o,a,s,c,p,f,m,y,h,v,g,b,w,x,E,_,j,k,I,S=(0,l.c)(76),{comlink:$,comlinkStatus:A,componentResolver:C,inFrame:O,inPopUp:T,zIndex:P}=e,R=(0,M.Xy)();S[0]===Symbol.for("react.memo_cache_sentinel")?(t={contextMenu:null,dragInsertPosition:null,dragShowMinimap:!1,dragShowMinimapPrompt:!1,dragSkeleton:null,elements:[],focusPath:"",isDragging:!1,perspective:"published",wasMaybeCollapsed:!1,dragMinimapTransition:!1,dragGroupRect:null},S[0]=t):t=S[0];let[L,N]=(0,d.useReducer)(ot,t),{contextMenu:D,dragInsertPosition:z,dragShowMinimap:U,dragShowMinimapPrompt:V,dragSkeleton:F,elements:Y,isDragging:W,perspective:q,wasMaybeCollapsed:G,dragMinimapTransition:H,dragGroupRect:X}=L,[J,K]=(0,d.useState)(null),[Z,Q]=(0,d.useState)(!0);S[1]!==$?(n=()=>{let e=[$?.on("presentation/focus",e=>{N({type:"presentation/focus",data:e})}),$?.on("presentation/blur",e=>{N({type:"presentation/blur",data:e})}),$?.on("presentation/toggle-overlay",()=>{Q(oj)})].filter(Boolean);return()=>e.forEach(ok)},r=[$],S[1]=$,S[2]=n,S[3]=r):(n=S[2],r=S[3]),(0,d.useEffect)(n,r),function(e,t){let n,r,i=(0,l.c)(4);i[0]!==e||i[1]!==t?(n=()=>{let n=new AbortController;e?.fetch("visual-editing/fetch-perspective",void 0,{signal:n.signal,suppressWarnings:!0}).then(e=>{t({type:"presentation/perspective",data:e})}).catch(op);let r=e?.on("presentation/perspective",e=>{t({type:"presentation/perspective",data:e})});return()=>{r?.(),n.abort()}},r=[e,t],i[0]=e,i[1]=t,i[2]=n,i[3]=r):(n=i[2],r=i[3]),(0,d.useEffect)(n,r)}($,N),function(e,t,n){let r,i,o,a=(0,l.c)(7),s=(0,d.useRef)(void 0);a[0]!==e?(r=(t,n)=>{e?.post("visual-editing/documents",{documents:t,perspective:n})},a[0]=e,a[1]=r):r=a[1];let u=r;a[2]!==t||a[3]!==n||a[4]!==u?(i=()=>{let e=t.map(oy).filter(om),r=new Set(e.map(of));if(!s.current||!function(e,t){if(e===t)return!0;if(e.size!==t.size)return!1;for(let n of e)if(!t.has(n))return!1;return!0}(r,s.current.nodeIds)||n!==s.current.perspective){let t=Array.from(r).map(t=>{let{type:n,projectId:r,dataset:i}=e.find(e=>e.id===t);return r&&i?{_id:t,_type:n,_projectId:r,_dataset:i}:{_id:t,_type:n}});s.current={nodeIds:r,perspective:n},u(t,n)}},o=[t,n,u],a[2]=t,a[3]=n,a[4]=u,a[5]=i,a[6]=o):(i=a[5],o=a[6]),(0,d.useEffect)(i,o)}($,Y,q),S[4]!==J?(i=(e,t)=>{J&&(J.style.setProperty("--drag-preview-x",`${e}px`),J.style.setProperty("--drag-preview-y",`${t-window.scrollY}px`))},S[4]=J,S[5]=i):i=S[5];let ee=i;S[6]===Symbol.for("react.memo_cache_sentinel")?(o=()=>{let e=!1,t=t=>{oE(t)&&e&&(e=!1,Q(oS))},n=t=>{if(oE(t)){if(t.ctrlKey||t.metaKey||t.shiftKey)return;e||(e=!0,Q(oM))}(function(e,t){return e.every(e=>ox[e]?t[ox[e]]:t.key===e.toUpperCase())})(["mod","\\"],t)&&Q(o$)},r=()=>{e&&(e=!1,Q(oA))};return window.addEventListener("click",oI),window.addEventListener("keydown",n),window.addEventListener("keyup",t),window.addEventListener("blur",r),()=>{window.removeEventListener("click",oI),window.removeEventListener("keydown",n),window.removeEventListener("keyup",t),window.removeEventListener("blur",r)}},a=[Q],S[6]=o,S[7]=a):(o=S[6],a=S[7]),(0,d.useEffect)(o,a);let[et,en]=(0,d.useState)(!1),[er,eo]=(0,d.useState)(!1),ea=(0,d.useRef)(void 0);S[8]!==Z?(s=()=>{if(Z)return ov(()=>{en(!0),ov(()=>{eo(!0),ea.current=setTimeout(()=>{eo(!1),en(!1)},1500)})});ea.current&&(clearTimeout(ea.current),en(!1),eo(!1))},c=[Z],S[8]=Z,S[9]=s,S[10]=c):(s=S[9],c=S[10]),(0,d.useEffect)(s,c),S[11]!==Y?(p=Y.flatMap(oC),S[11]=Y,S[12]=p):p=S[12];let es=p;S[13]===Symbol.for("react.memo_cache_sentinel")?(f=()=>{N({type:"overlay/blur"})},S[13]=f):f=S[13];let eu=f,el=ei()!==B,ec=el?C:void 0;e:{let t;if((O||T)&&"connected"!==A||W){let e;S[14]===Symbol.for("react.memo_cache_sentinel")?(e=[],S[14]=e):e=S[14],m=e;break e}S[15]!==$||S[16]!==ec||S[17]!==H||S[18]!==U||S[19]!==Y||S[20]!==O||S[21]!==W||S[22]!==el||S[23]!==e.plugins||S[24]!==G?(t=Y.filter(oO).map(t=>{let{id:n,element:r,focused:i,hovered:o,rect:a,sanity:s,dragDisabled:l,targets:c,elementType:d}=t,p=!l&&!!r.getAttribute("data-sanity")&&el&&Y.some(e=>"id"in e.sanity&&"id"in s&&te(e.sanity,s)&&e.sanity.path!==s.path);return(0,u.jsx)(iG,{comlink:$,componentResolver:ec,plugins:e.plugins,element:r,enableScrollIntoView:!W&&!H&&!U,id:n,focused:i,hovered:o,node:s,rect:a,showActions:!O,draggable:p,isDragging:W||H,wasMaybeCollapsed:i&&G,targets:c,elementType:d},n)}),S[15]=$,S[16]=ec,S[17]=H,S[18]=U,S[19]=Y,S[20]=O,S[21]=W,S[22]=el,S[23]=e.plugins,S[24]=G,S[25]=t):t=S[25],m=t}let ed=m,ep=R?"dark":"light",ef=er?"":void 0,em=et?"":void 0;return S[26]!==es||S[27]!==q?(y=(0,u.jsx)(og,{documentIds:es,perspective:q}),S[26]=es,S[27]=q,S[28]=y):y=S[28],S[29]!==$||S[30]!==O||S[31]!==T||S[32]!==Z||S[33]!==J||S[34]!==ee?(h=(0,u.jsx)(ob,{comlink:$,dispatch:N,inFrame:O,inPopUp:T,onDrag:ee,overlayEnabled:Z,rootElement:J}),S[29]=$,S[30]=O,S[31]=T,S[32]=Z,S[33]=J,S[34]=ee,S[35]=h):h=S[35],S[36]!==D?(v=D&&(0,u.jsx)(iL,{...D,onDismiss:eu}),S[36]=D,S[37]=v):v=S[37],S[38]!==X||S[39]!==z||S[40]!==H||S[41]!==V||S[42]!==W?(g=W&&!H&&(0,u.jsxs)(u.Fragment,{children:[z&&(0,u.jsx)(i4,{dragInsertPosition:z}),V&&(0,u.jsx)(oe,{}),X&&(0,u.jsx)(i3,{dragGroupRect:X})]}),S[38]=X,S[39]=z,S[40]=H,S[41]=V,S[42]=W,S[43]=g):g=S[43],S[44]!==F||S[45]!==W?(b=W&&F&&(0,u.jsx)(i6,{skeleton:F}),S[44]=F,S[45]=W,S[46]=b):b=S[46],S[47]!==ed||S[48]!==ef||S[49]!==em||S[50]!==y||S[51]!==h||S[52]!==v||S[53]!==g||S[54]!==b||S[55]!==P?(w=(0,u.jsxs)(oh,{"data-fading-out":ef,"data-overlays":em,ref:K,$zIndex:P,children:[y,h,v,ed,g,b]}),S[47]=ed,S[48]=ef,S[49]=em,S[50]=y,S[51]=h,S[52]=v,S[53]=g,S[54]=b,S[55]=P,S[56]=w):w=S[56],S[57]!==$||S[58]!==w?(x=(0,u.jsx)(ou,{comlink:$,children:w}),S[57]=$,S[58]=w,S[59]=x):x=S[59],S[60]!==$||S[61]!==x?(E=(0,u.jsx)(on,{comlink:$,children:x}),S[60]=$,S[61]=x,S[62]=E):E=S[62],S[63]!==$||S[64]!==Y||S[65]!==E?(_=(0,u.jsx)(oo,{comlink:$,elements:Y,children:E}),S[63]=$,S[64]=Y,S[65]=E,S[66]=_):_=S[66],S[67]!==J||S[68]!==_?(j=(0,u.jsx)(M.XS,{children:(0,u.jsx)(M.GD,{element:J,children:_})}),S[67]=J,S[68]=_,S[69]=j):j=S[69],S[70]!==ep||S[71]!==j?(k=(0,u.jsx)(M.NP,{scheme:ep,theme:M.Qx,tone:"transparent",children:j}),S[70]=ep,S[71]=j,S[72]=k):k=S[72],S[73]!==$||S[74]!==k?(I=(0,u.jsx)(od,{comlink:$,children:k}),S[73]=$,S[74]=k,S[75]=I):I=S[75],I},ox={alt:"altKey",ctrl:"ctrlKey",mod:"u">typeof window&&/Mac|iPod|iPhone|iPad/.test(window.navigator.platform)?"metaKey":"ctrlKey",shift:"shiftKey"};function oE(e){return"Alt"===e.key}function o_(e,t){return e.filter(e=>e!==t)}function oj(e){return!e}function ok(e){return e()}function oI(e){let t=e.target;if(((0,M.nY)(t)||(0,M.sb)(t)&&t.closest("a"))&&e.altKey){e.preventDefault(),e.stopPropagation();let t=new MouseEvent(e.type,{...e,altKey:!1,bubbles:!0,cancelable:!0});e.target?.dispatchEvent(t)}}function oS(e){return!e}function oM(e){return!e}function o$(e){return!e}function oA(e){return!e}function oC(e){return"id"in e.sanity?[e.sanity.id]:[]}function oO(e){return e.activated||e.focused}let oT=e=>{let t,n,r=(0,l.c)(4),{comlink:i,refresh:o}=e,a=(0,d.useRef)(0),s=(0,d.useRef)(0);return r[0]!==i||r[1]!==o?(t=()=>i.on("presentation/refresh",e=>{if("manual"===e.source){clearTimeout(a.current);let t=o(e);if(!1===t)return;i.post("visual-editing/refreshing",e);let n=!1;a.current=window.setTimeout(()=>{i.post("visual-editing/refreshed",e),n=!0},3e3),t?.finally?.(()=>{n||(clearTimeout(a.current),i.post("visual-editing/refreshed",e))})}else if("mutation"===e.source){clearTimeout(s.current);let t=o(e);if(!1===t)return;i.post("visual-editing/refreshing",e),s.current=window.setTimeout(()=>{let t=o(e);!1!==t&&(i.post("visual-editing/refreshing",e),t?.finally?.(()=>{i.post("visual-editing/refreshed",e)})||i.post("visual-editing/refreshed",e))},1e3),t?.finally?.(()=>{i.post("visual-editing/refreshed",e)})||i.post("visual-editing/refreshed",e)}}),n=[i,o],r[0]=i,r[1]=o,r[2]=t,r[3]=n):(t=r[2],n=r[3]),(0,d.useEffect)(t,n),null};function oP(e){let{data:t,origin:n}=e;t&&"object"==typeof t&&"domain"in t&&"sanity/channels"===t.domain&&"from"in t&&"presentation"===t.from&&"type"in t&&"presentation/status"===t.type&&window.parent.postMessage({domain:"sanity/channels",type:"visual-editing/status",data:{origin:location.origin}},n)}function oR(){console.warn("[@sanity/visual-editing] Package version mismatch detected: Please update your Sanity studio to prevent potential compatibility issues.")}function oL(){}let oN=e=>{let t,n,r,i,o,a,s,f,m=(0,l.c)(23),{components:y,plugins:h,history:v,portal:g,refresh:b,zIndex:w}=e,x=void 0===g||g,[E,_]=(0,d.useState)(null),[j,k]=(0,d.useState)(null);m[0]===Symbol.for("react.memo_cache_sentinel")?(t=()=>{_((0,c.Fk)()),k((0,c.v$)())},n=[],m[0]=t,m[1]=n):(t=m[0],n=m[1]),(0,d.useEffect)(t,n);let[I,S]=(0,d.useState)(null);m[2]!==x?(r=()=>{if(!1===x)return;let e=document.createElement("sanity-visual-editing");return document.documentElement.appendChild(e),S(e),()=>{S(null),document.documentElement.contains(e)&&document.documentElement.removeChild(e)}},i=[x],m[2]=x,m[3]=r,m[4]=i):(r=m[3],i=m[4]),(0,d.useEffect)(r,i);let[M,$]=function(e){let t,n,r,i,o,a=(0,l.c)(9),s=void 0===e||e,[u,p]=(0,d.useState)(),[f,m]=(0,d.useState)("idle");return a[0]!==s?(t=()=>{if(!s)return;let e=(0,t_.RM)({name:"visual-editing",connectTo:"presentation"},(0,t_.Uc)().provide({actors:(0,c.jF)()})),t=e.onStatus(()=>m("connected"),"connected");p(e);let n=e.start();return()=>{t(),n(),p(void 0)}},n=[s],a[0]=s,a[1]=t,a[2]=n):(t=a[1],n=a[2]),(0,d.useEffect)(t,n),a[3]!==f?(r=()=>{if("connected"===f)return;let e=new AbortController;return window.addEventListener("message",oP,{signal:e.signal}),()=>{e.abort()}},i=[f],a[3]=f,a[4]=r,a[5]=i):(r=a[4],i=a[5]),(0,d.useEffect)(r,i),a[6]!==u||a[7]!==f?(o=[u,f],a[6]=u,a[7]=f,a[8]=o):o=a[8],o}(!0===E||!0===j);!function(e){let t,n,r=(0,l.c)(3);r[0]!==e?(t=()=>{if(!e)return;let t=function(e){let t=new tk.m(1),n=new tI.B;return e.fetch("visual-editing/snapshot-welcome",void 0,{suppressWarnings:!0}).then(e=>{t.next(e.event)}).catch(()=>{}),e.on("presentation/snapshot-event",e=>{"reconnect"===e.event.type&&t.next(e.event),"mutation"===e.event.type&&n.next(e.event)}),(0,tS.h)(t,n)}(e),n=ix.provide({actors:{documentMutatorMachine:(e=>{let t=(0,q.Sx)(async({input:t,signal:n})=>{let{id:r}=t,{snapshot:i}=await e.fetch("visual-editing/fetch-snapshot",{documentId:r},{signal:n});return i}),n=(0,q.Sx)(async({input:t})=>{let{transactions:n}=t;for(let t of n){let n=U.encodeTransaction(t);return e.post("visual-editing/mutate",n)}});return ib.provide({actions:{"send sync event to parent":(0,r1.a)(({enqueue:e})=>{e.sendParent(({context:e})=>({type:"sync",id:e.id,document:e.remote})),e.emit(({context:e})=>({type:"ready",snapshot:e.local}))})},actors:{"fetch remote snapshot":t,"submit mutations as transactions":n}})})(e)}}),r=(0,tj.c)(n,{input:{client:{withConfig:oL},sharedListener:t}});r.start();let i=new AbortController;return e.fetch("visual-editing/features",void 0,{signal:i.signal,suppressWarnings:!0}).then(e=>{e.features.optimistic&&function(e){for(let t of(G=e,H))t()}(r)}).catch(oR),()=>{r.stop(),i.abort()}},n=[e],r[0]=e,r[1]=t,r[2]=n):(t=r[1],n=r[2]),(0,d.useEffect)(t,n)}("connected"===$?M:void 0),m[5]!==M||m[6]!==$||m[7]!==y||m[8]!==E||m[9]!==j||m[10]!==h||m[11]!==w?(o=null!==E&&null!==j&&(0,u.jsx)(ow,{comlink:M,comlinkStatus:$,componentResolver:y,plugins:h,inFrame:E,inPopUp:j,zIndex:w}),m[5]=M,m[6]=$,m[7]=y,m[8]=E,m[9]=j,m[10]=h,m[11]=w,m[12]=o):o=m[12],m[13]!==M||m[14]!==v||m[15]!==b?(a=M&&(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)(iE,{comlink:M,history:v}),(0,u.jsx)(i_,{comlink:M}),b&&(0,u.jsx)(oT,{comlink:M,refresh:b})]}),m[13]=M,m[14]=v,m[15]=b,m[16]=a):a=m[16],m[17]!==o||m[18]!==a?(s=(0,u.jsxs)(u.Fragment,{children:[o,a]}),m[17]=o,m[18]=a,m[19]=s):s=m[19];let A=s;return!1!==x&&I?(m[20]!==A||m[21]!==I?(f=(0,p.createPortal)(A,I),m[20]=A,m[21]=I,m[22]=f):f=m[22],f):A};oN.displayName="VisualEditing";var oD=n(20063),oz=n(24112);function oU(e){let t=e.indexOf("#"),n=e.indexOf("?"),r=n>-1&&(t<0||n<t);return r||t>-1?{pathname:e.substring(0,r?n:t),query:r?e.substring(n,t>-1?t:void 0):"",hash:t>-1?e.slice(t):""}:{pathname:e,query:"",hash:""}}function oV(e,t){if(!function(e,t){if("string"!=typeof e)return!1;let{pathname:n}=oU(e);return n===t||n.startsWith(`${t}/`)}(e,t))return e;let n=e.slice(t.length);return n.startsWith("/")?n:`/${n}`}function oF(e){let{basePath:t="",plugins:n,components:r,refresh:i,trailingSlash:o=!1,zIndex:a}=e,s=(0,oD.useRouter)(),l=(0,d.useRef)(s),[c,p]=(0,d.useState)();(0,d.useEffect)(()=>{l.current=s},[s]);let f=(0,d.useMemo)(()=>({subscribe:e=>(p(()=>e),()=>p(void 0)),update:e=>{switch(e.type){case"push":return l.current.push(oV(e.url,t));case"pop":return l.current.back();case"replace":return l.current.replace(oV(e.url,t));default:throw Error(`Unknown update type: ${e.type}`)}}}),[t]),m=(0,oD.usePathname)(),y=(0,oD.useSearchParams)();(0,d.useEffect)(()=>{c&&c({type:"push",url:((e,t)=>{let{pathname:n,query:r,hash:i}=oU(e);return t?n.endsWith("/")?`${n}${r}${i}`:`${n}/${r}${i}`:`${n.replace(/\/$/,"")||"/"}${r}${i}`})(function(e,t){if(!e.startsWith("/")||!t)return e;if("/"===e&&t)return t;let{pathname:n,query:r,hash:i}=oU(e);return`${t}${n}${r}${i}`}(`${m}${y?.size?`?${y}`:""}`,t),o)})},[t,c,m,y,o]);let h=(0,d.useCallback)(e=>{if(i)return i(e);switch(e.source){case"manual":return e.livePreviewEnabled?(console.debug("Live preview is setup, calling router.refresh() to refresh the server components without refetching cached data"),l.current.refresh(),Promise.resolve()):(console.debug("No loaders in live mode detected, or preview kit setup, revalidating root layout"),(0,oz.q)());case"mutation":return e.livePreviewEnabled?(console.debug("Live preview is setup, mutation is skipped assuming its handled by the live preview"),!1):(console.debug("No loaders in live mode detected, or preview kit setup, revalidating root layout"),(0,oz.q)());default:throw Error("Unknown refresh source",{cause:e})}},[i]);return(0,u.jsx)(oN,{plugins:n,components:r,history:f,portal:!0,refresh:h,zIndex:a})}}}]);